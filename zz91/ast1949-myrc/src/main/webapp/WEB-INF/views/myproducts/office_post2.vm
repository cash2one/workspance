<script src="$!{address.img}/lib/asto/asto-all-1.0.0.js"></script>
<link rel="stylesheet" href="http://img0.zz91.com/zz91/myrc/css/myproducts.css" />
<script src="http://img0.zz91.com/zz91/myrc/js/myproducts.js"></script>
<script type="text/javascript" src="http://img0.zz91.com/zz91/js/openoverlay.js"></script>
<link type="text/css" rel="stylesheet" href="http://img0.zz91.com/zz91/css/openoverlay2.css" />
<script language="javascript" src="http://img0.zz91.com/zz91/myrc/js/jquery.Sonline2.js"></script>
<script type="text/javascript" src="$!{address.img}/bbs/js/ckeditor/ckeditor.js"></script>

#set( $layout = "/layout/default.vm" )

<div class="container">
	<div class="process-bar">
		<ul class="clearfix">
			<li>第一步：填写基本信息<s class="l"></s><s class="r"></s></li>
			<li class="active">第二步：填写详细信息<s class="l"></s><s class="r"></s></li>
			<li>第三步：发布成功<s class="l"></s><s class="r"></s></li>
		</ul>
	</div>
	#set($typename = "供应")
	#if($!{productsDO.productsTypeCode}=="10331001")
		#set($typename = "求购")
	#end
	<div class="alert alert-info"> 
		<strong>提醒：</strong>您已选择了类别：<span class="org">$!{mainCodeLabels}</span>
		<a href="#springUrl('/myproducts/office_post1.htm')?categoryProductsMainCode=$!{productsDO.categoryProductsMainCode}&categoryProductsAssistCode=$!{productsDO.categoryProductsAssistCode}&productsTypeCode=$!{productsDO.productsTypeCode}&title=$!{titleEncode}&mainCodeLabel=$!{mainCodeLabelEncode}&mainCodeLabels=$!{mainCodeLabelsEncode}" id="linktags" title="点击修改类别">
			点击这里可以重新修改类别
		</a>，<b>但是您现在填写的供求信息将会丢失，请谨慎操作！</b>
	</div>
	<div class="SonlineBox" id="SonlineBox">
		<div class="contentBox">
			<div class="titleBox">完整度：<span id="num" >5</span>%</div>
			<div class="listBox">
				<table class="tab-list" cellpadding="0" cellspacing="0">
					<tr><th><i id="cmpltlvl" class="lv0"></i>产品星级:</th></tr>
					<tr><td><a action-data="1F" onclick="bookmarks(this);"><i class="gtick"></i><span>完善交易条件</span></a></td></tr>
					<tr><td><a action-data="2F" onclick="bookmarks(this);"><i class="gtick"></i><span>完善产品属性</span></a></td></tr>
					<tr><td><a action-data="3F" onclick="bookmarks(this);"><i class="gtick"></i><span>上传产品图片</span></a></td></tr>
					<tr><td><a action-data="4F" onclick="bookmarks(this);"><i class="gtick"></i><span>丰富信息描述</span></a></td></tr>
					<tr><td><a href="http://help.zz91.com/detail-124/" target="_blank" class="case">查看优质案例</a></td></tr>
				</table>
			</div>
		</div>
	</div>
	<form id="editForm" name="editForm" method="post" action="#springUrl('/myproducts/publishProducts.htm')">
		<input id="categoryProductsMainCode" type="hidden" name="categoryProductsMainCode" value="$!{productsDO.categoryProductsMainCode}" />
		<input id="categoryProductsAssistCode" type="hidden" name="categoryProductsAssistCode" value="$!{productsDO.categoryProductsAssistCode}"/>
		<input id="productsTypeCode" type="hidden" name="productsTypeCode" value="$!{productsDO.productsTypeCode}"/>
		<input id="isShowInPrice" type="hidden" name="isShowInPrice" value="0" />
		<!-- part I Start -->
		<h3 class="divide" style="font-size:16px">请填写产品详细信息</h3>
		##基本信息
		<div class="control-group">
			<label for="title" class="control-label">
				<span class="red">*</span>产品名称：
			</label>
			<div class="controls">
				<input name="title" type="text" id="title" value="$!{productsDO.title}" class="field input-xlarge validate[required,maxSize[50],ajax[ajaxTitle]]">
				<span class="grey">建议在标题中包含产品名称和相应关键词，如:白色PP吨包袋颗粒</span>
			</div>
		</div>
		<div class="control-group">
			<label for="tags" class="control-label">
				<span class="red">*</span>产品标签：
			</label>
			<div class="controls">
				<input name="tags" type="text" id="tags" value="$!{mainCodeLabel}" class="field input-xlarge validate[required,maxSize[100]]" />
				<span class="grey">让客户更快更准找到您!多个标签用逗号(,)隔开, 建议填写 1~5个。 <a href="http://help.zz91.com/detail-54/" target="_blank" id="linktags" title="点击查看在线帮助，教你如何填写标签">怎样填标签!</a></span>
				<p><span style="color:#009900">示例1</span>：标题为求购&lt;白色PP吨包袋颗粒&gt;，标签可以是&lt;白色PP吨包袋颗粒,求购白色PP吨包袋颗粒,PP颗粒,回收PP颗粒,PP吨包袋颗粒等&gt;</p>
				<p><span style="color:#009900">示例2</span>：标题为供应&lt;废铜&gt;，标签可以是&lt;废铜,供应废铜,出售废铜,废铜供应,废铜出售等&gt;</p>
			</div>
		</div>
		
		<div class="control-box" id="1F">
            <div class="control-box-title">
				交易条件：
			</div>
            <div class="cb"></div>
        </div>
		
		#if($!{ypStatus}==1&&$!{productsDO.productsTypeCode}=="10331000")
		<div class="control-group">
			<b style="font-size:14px;">
				一、基本交易条件：
			</b>
		</div>
		#end
		
        <!--end control-box-->
		<div class="control-group">
			<label for="shipDay" class="control-label"><span class="red">*</span>期货现货：</label>
			<div class="controls">
				<label class="radio"><input type="radio" name="goodsTypeCode" value='10361001' />现货(发布现货供求请点击“<span class="red">现货</span>”)</label>
				<label class="radio"><input type="radio" name="goodsTypeCode" value='10361000' />期货</label>
				<label class="radio"><input type="radio" name="goodsTypeCode" value='10361002' checked />其他</label>
			</div>
		</div>
		<div class="control-group">
			<label for="quantity" class="control-label">
				<span class="red">*</span>$!{typename}数量：
			</label>
			<div class="controls">
				<input name="quantity" type="text" id="quantity" class="field input-small validate[required,custom[number]]" maxlength="6">
			</div>
		</div>
		<div class="control-group">
			<label class="control-label"><span class="red">*</span>计量单位：</label>
			<div class="controls">
    			<label class="radio"><input type="radio" name="quantityUnit" value='吨' checked />吨</label>
    			<label class="radio"><input type="radio" name="quantityUnit" value='千克' />千克</label>
    			<label class="radio"><input type="radio" name="quantityUnit" value='斤' />斤</label>
				<label class="radio"><input type="radio" name="quantityUnit" value='台' />台</label>
				<label class="radio"><input type="radio" name="quantityUnit" value='辆' />辆</label>
    			<label class="radio">
    				<input type="radio" name="quantityUnit" value='' id="myQuantityUnit">其他
    			</label>
    			<span id="otherQuantity" class="hidden">
    				：<input type="text" value="" id="otherU1" class="field input-small">
    			</span>
			</div>
		</div>
		<div class="control-group">
			<label class="control-label"><span class="red">*</span>报价：</label>
			<div class="controls">
				<label class="radio"><input type="radio" class="opPrice" name="opPrice" value="0" checked>公开价格</label>
				<label class="radio"><input type="radio" class="opPrice" name="opPrice" value="1">电议或面议</label>
				<span class="grey">建议您选择公开报价，真实的价格有助于买/卖家找到您！</span>
				<div id="priceDetail">
					价格：<input name="minPrice" type="text" id="minPrice" value="" maxlength="6" size="10" class="field input-small validate[required,custom[number],min[1]]" />
					<span id="priceFlag" class="hidden">
						至
						<input name="maxPrice" type="text" id="maxPrice"   value="" class="field input-small validate[custom[number],min[1],funcCall[checkMaxPrice]]" />
					</span>
					<label class="checkbox"><input type="checkbox" name="togglePrice" id="togglePrice" value="1" />支持价格范围</label>
				</div>
			</div>
		</div>
		
		<div class="control-group" id="priceDetail2">
			<label class="control-label">&nbsp;</label>
			<div class="controls">
				<div>
					货币单位：<label class="radio"><input type="radio" name="priceUnit" value='元' checked />元</label>
					<label class="radio"><input type="radio" name="priceUnit" value='美元' />美元</label>
					<label class="radio"><input type="radio" name="priceUnit" value='欧元' />欧元</label>
					<label class="radio"><input type="radio" name="priceUnit" value='欧元' />日元</label>
					<label class="radio"><input type="radio" name="priceUnit" value='' id="myPriceUnit" maxlength="6" />其他</label>
					<span id="otherQuantityPrice" class="hidden">
						：<input id="otherUnit" type="text" value="" class="field input-small" />
					</span>
				</div>
			</div>
		</div>
		
		<div class="control-group">
			<label class="control-label">交易说明：</label>
			<div class="controls">
				<input type="radio" name="transaction" value="提供样品" #if($!{ypStatus}==1) checked #end />提供样品
				<input type="radio" name="transaction" value="支持线下看货" />支持线下看货
    			<input type="radio" name="transaction" value="指定销售地区" id="transactionValue" />
    			<label for="transactionValue">指定销售地区</label>
				<input type="text" class="field input-small" name="transactionArea" id="transactionArea" />
				<script>
					jQuery("#transactionArea").on({
					   	"blur": function(){
							jQuery("#transactionValue").val("指定销售地区"+jQuery("#transactionArea").val())
						},
						"click": function(){
							jQuery('#transactionValue').attr('checked', true);
						}
					});
				</script>
			</div>
		</div>
		<div class="control-group">
			<label for="shipDay" class="control-label">发货时间：</label>
			<div class="controls">
				<input name="shipDay" type="text" id="shipDay" class="field input-small validate[custom[number]]">
				<span class="grey">天内可以发货</span>
			</div>
		</div>
		
		## 现货所在地
		<div class="control-group" id="J_spotAddr">
			<div class="control-group">
				<label class="control-label">现货物所在地：</label>
				<div class="controls">
					<p>
						<select id='reg-area-0'>
							<option value="">请选择国家</option>
						</select>
						<select id='reg-area-1'>
							<option value="">请选择省份</option>
						</select>
						<select id='reg-area-2'>
							<option value="">请选择城市</option>
						</select>
						<input name="location" type="hidden" id="location" class="field" />
					</p>
				</div>
			</div>
		</div>
		
		#if($!{ypStatus}==1&&$!{productsDO.productsTypeCode}=="10331000")
		<div class="control-group">
			<b style="font-size:14px;">
				二、样品交易条件：
			</b>
		</div>
		
		<div class="control-group">
			<label for="quantity" class="control-label">
				<span class="red">*</span>样品数量：
			</label>
			<div class="controls">
				<input name="amount" type="text" id="amount" class="field input-small validate[required,custom[integer],min[1]]" maxlength="6" style="border:1px solid #ff822e" /> 件
			</div>
		</div>
		<div class="control-group">
			<label for="quantity" class="control-label">
				<span class="red">*</span>样品单件重量：
			</label>
			<div class="controls">
				<input name="weight" type="text" id="weight" class="field input-small validate[required,custom[number],min[0]]" maxlength="6" style="border:1px solid #ff822e" /> 千克/件
			</div>
		</div>
		<div class="control-group">
			<label class="control-label"><span class="red">*</span>拿样价格：</label>
			<div class="controls">
				<input name="takePrice" type="text" id="takePrice" value="" maxlength="6" size="10" class="field input-small validate[required,custom[number],min[1]]" style="border:1px solid #ff822e" /> 元
			</div>
		</div>
		<div class="control-group">
			<label class="control-label"><span class="red">*</span>运费：</label>
			<div class="controls">
				<label class="radio"><input type="radio" class="sendPriceFreeClick" name="sendPriceFreeClick" value="1" checked>买家承担运费</label>
				<label class="radio"><input type="radio" class="sendPriceFreeClick" name="sendPriceFreeClick" value="0">免运费</label>
					
				<div id="sendPriceFreeDetail" style="margin-top:5px;">
					<input name="sendPrice" type="text" id="sendPrice" value="" maxlength="6" size="10" class="field input-small validate[required,custom[number],min[1]]" style="border:1px solid #ff822e" /> 元 &nbsp;
					<label class="checkbox"><input type="checkbox" id="isCashDelivery"   name="isCashDelivery"   value="1"><font color="red">支持货到付款</font> （买家收到货后，由买家支付运费）</label> 
				</div>
			</div>
		</div>
		
		<script type="text/javascript">
			jQuery(".sendPriceFreeClick").click(function () {
        		var s = jQuery(":input[name='sendPriceFreeClick'][checked]").val();
        		if (s == 0) {
					jQuery("#sendPrice").val(0);
					jQuery("#isCashDelivery").val(0);
        			jQuery("#sendPriceFreeDetail").hide();
        			jQuery("#sendPrice").validationEngine("hide");
        		} else {
					jQuery("#sendPrice").val("");
        			jQuery("#sendPriceFreeDetail").show();
        		}
        	});
        </script>
		
		## 发货地址
		<div class="control-group" >
			<div class="control-group">
				<label class="control-label"><span class="red">*</span>发货地址：</label>
				<div class="controls">
					<p>
						<select id='yp-area-1' style="border:1px solid #ff822e">
							<option value="">请选择省份</option>
						</select>
						<select id='yp-area-2' class="validate[required]" style="border:1px solid #ff822e">
							<option value="">请选择城市</option>
						</select>
						<input name="areaCode" type="hidden" id="areaCode" class="field" />
					</p>
				</div>
			</div>
		</div>
		
		<script type="text/javascript">
		
			var regarea = new Asto.util.Selector({
				selects:["#yp-area-1","#yp-area-2"],
				assistSelects:["#reg-garden"],
				url:"#springUrl('/category/areaChild.htm')",
				assistUrl:"#springUrl('/category/gardenChild.htm')",
				changeCallback:function(c,idx){
					setAreaCode();
				}
			});
			
			regarea.init({
				rootCode:"10011000",
				initCode:"10011000",
				initAssistCode:""
			});
		
			function setAreaCode(){
        		var areacode=jQuery("#yp-area-1").val();
        		if(jQuery("#reg-area-1").val()!=""){
        			areacode=jQuery("#yp-area-1").val();
        		}
        		if(jQuery("#yp-area-2").val()!=""){
        			areacode=jQuery("#yp-area-2").val();
        		}
        		jQuery("#areaCode").val(areacode);
        	}
		</script>
		
		#end
	
    	<div class="control-box" id="2F">
            <div class="control-box-title">
				产品属性：
            </div>
            <div class="control-box-text">
				完善产品属性，有助于买家/卖家搜索查找到您的信息，增加信任感
            </div>
            <div class="control-box-button">
				<a href="http://help.zz91.com/detail-78/" target="_blank"><input type="button" class="btn" value="效果展示图"></a>
            </div>
            <div class="cb"></div>
        </div>
        <!--end control-box-->
		<div class="control-group hidden" id="color_item">
			<label class="control-label">
				#if($!{ypStatus}==1)
					<span class="red">*</span>
				#end
				颜色：
			</label>
			<div class="controls">
				<input type="text" name="color" id="color" #if($!{ypStatus}==1) class="field input-small validate[required,maxSize[50]]" #else class="field input-small validate[maxSize[50]]"  #end style="width:280px"/>
				（如：本色、白色、黑色、灰色、红色、蓝色、杂色等）
			</div>
		</div>
		<div class="control-group hidden" id="grade_item">
			<label class="control-label">
				品位：
			</label>
			<div class="controls">
				<input type="text" class="field input-small validate[maxSize[100]]" id="grade" name="grade" style="width:280px"/>
			</div>
		</div>
		
		<div class="control-group hidden" id="shape_item">
			<label class="control-label">
				#if($!{ypStatus}==1)
					<span class="red">*</span>
				#end
				形态：
            </label>
            <div class="controls">
				<input type="text" name="shape" id="shape" #if($!{ypStatus}==1) class="field input-small validate[required,maxSize[50]]" #else class="field input-small validate[maxSize[50]]" #end style="width:280px"/>
            	（如：片状、颗粒、破碎、原状未加工、其他）
            </div>
        </div>
		
        <div class="control-group hidden" id="level_item">
			<label class="control-label">
				#if($!{ypStatus}==1)
					<span class="red">*</span>
				#end
				级别：
            </label>
            <div class="controls">
				<input type="text" name = "level" id="level" #if($!{ypStatus}==1) class="field input-small validate[required,maxSize[50]]" #else class="field input-small validate[maxSize[50]]" #end style="width:280px" />
            	（如：特级、一级、二级、其他）
            </div>
        </div>
		
        <div class="control-group hidden" id="appearance_item">
			<label class="control-label">
            	外观：
			</label>
            <div class="controls">
				<input type="text" id="appearance" class="field input-small validate[maxSize[50]]" name = "appearance" style="width:280px" />
            	（如：光滑、干净、未处理、其他）
            </div>
        </div>
		
		<div class="control-group">
			<label class="control-label">
            	货源地：
            </label>
            <div class="controls">
				<input type="text" id="source" class="field input-small validate[maxSize[100]]" name = "source" style="width:280px" />
            	（此货物来源地，如：国外、美国、国内...）
            </div>
        </div>
		
		<div class="control-group">
			<label class="control-label">
				来源产品：
			</label>
			<div class="controls">
				<input type="text" id="origin" class="field input-small validate[maxSize[100]]" name = "origin" style="width:280px" />
			</div>
		</div>
		
		<div class="control-group" >
			<label class="control-label">
				产品规格：
			</label>
			<div class="controls">
				<input type="text" id="specification" class="field input-small validate[maxSize[100]]" name = "specification" style="width:280px" />
				（如：产品大小30cm*50cm、厚度20mm...）
			</div>
		</div>
		
		<div class="control-group hidden" id="useful_item">
			<label class="control-label">
				#if($!{ypStatus}==1)
					<span class="red">*</span>
				#end
				此废料可用于：
			</label>
			<div class="controls">
				<input type="text" name="useful" id="useful" #if($!{ypStatus}==1) class="field input-small validate[required,maxSize[100]]" #else class="field input-small validate[maxSize[100]]" #end style="width:280px"  />
				（此货品加工后的用途，如：造粒、注塑...）
			</div>
        </div>
        
        <div class="control-group hidden" id="impurity_item">
			<label class="control-label">
            	杂质（杂物）含量：
            </label>
            <div class="controls">
				<input type="text" id="impurity" class="field input-small validate[maxSize[20]]" name="impurity" style="width:280px" />
            	（请写明具体杂质及其含量）
            </div>
        </div>
		
		<div class="control-group">
			<label class="control-label">加工说明：</label>
			#foreach($manu in $!{manufactureList.keySet()})
				<label class="radio"><input type="radio" class="validate[maxSize[100]]" name="manufacture" value="$!{manu}" >$!{manufactureList.get($manu)}</label>
			#end
        </div>
		<div class="control-group hidden" id ="addProp_item">
            <div id="item"></div>
			
			<div class="b-item hidden" id = "add_tishi">
            	<p style="color:#b94a48; margin-left:88px;"><strong><b>注： 属性和属性值</b></strong>都不能含有逗号(，)。如果需要则用顿号(、)代替。
                </p>
                <p style="color:#b94a48; margin-left:88px;"><strong><b>1. 属性：</b></strong>请根据具体产品填写，例如废金属，属性一栏可填写品位，形态，颜色等
                </p>
				<p style="color:#b94a48; margin-left:88px;"><strong><b>2. 属性值：</b></strong>请根据属性填写，例如属性为颜色，属性值则为红色
                </p>
            </div>
			
            <div class="b-item">
            	<div class="b-item-addimg fl">
                	<a href="#"></a>
                </div>
                <div class="b-item-addtext fl" id="item-addtext">
                	<a id="additem" >添加产品属性</a>
                    如果您觉得我们提供的产品属性无法满足您的需要，您可以手动添加产品属性
                </div>
				
                <div class="cb"></div>
            </div>
            <!--end b-item-->
        </div>
		
		<div class="control-box">
			<div class="control-box-title">
				产品图片和描述：
			</div>
			<div class="control-box-text">
				上传实拍产品图和丰富产品详情，让产品更具吸引力，获得好排名，帮助目标客户直观了解产品细节
			</div>
			<div class="control-box-button">
				<a href="http://help.zz91.com/detail-79/" target="_blank"><input type="button" class="btn" value="效果展示图" /></a>
			</div>
			<div class="cb"></div>
		</div>
		<!--end control-box-->
		
		<div class="control-group">
			<label class="control-label" id="3F">
				#if($!{ypStatus}==1&&$!{productsDO.productsTypeCode}=="10331000")
					<span class="red">*</span>
				#end
				产品图片：
			</label>
			<div class="controls clearfix">
			#foreach($pic in [1..5])
				<div class="upload-wrap">
					<img id="previewImg$pic" src="$!{address.images}/global/noimage.gif" name="imag" width="75" height="75" border="1">
					<br />
					<input type="button" value="上传" class="uploadBtn btn" id="uploadBtn_$pic">
					<input type="hidden" value="" name="picIds" id="previewId$pic" >
                </div>
			#end
			<div class="error-wrap fl" id="picErrorContent" style="display:none">
				<span style="color:#B94A48">*请上传产品图片</span>
			</div>
			</div>
			<div class="controls" id="picErr">
				<span>第一张图片为默认主图, 建议上传横图(图片大小：600*480), 图片清晰, 避免全文字。</span>
			</div>
		</div>
        <style>
        	#cke_13{display:none;}
            #cke_14{display:none;}
        </style>
		<div class="control-group" id="4F">
			<label for="details" class="control-label"><span class="red">*</span>信息描述：</label>
			<div class="controls">
				#if($!{productsDO.productsTypeCode}=="10331001") 
					#set($title = "求购" + $!{productsDO.title})
				#else 
					#set($title = "供应" + $!{productsDO.title})
				#end
				<input type="hidden" id="detailsStr" value=""/>
				<input type="button" class="btn" value="自动生成信息描述" onclick="appendDetail()"/>
				<input type="button" class="btn" onclick="upload()" value="插入图片"/>
				<span style="color:#ff0000;">&nbsp;点击插入图片，可在信息描述里面展示产品细节，丰富产品内容</span>
				<div id="uu">
				<textarea name="details" cols="80" rows="10" id="content" value=""></textarea>###if($!{productsDO.productsTypeCode}=="10331001") 求购：#else 供应：#end$!{productsDO.title} 
				</div>
				<p id="js-tip" class="red hidden">请注意：请勿在此填入电话、手机、邮箱、网址等联系方式，否则本站将不予审核通过，谢谢合作！</p>
				<p>
    				<label class="radio"><input type="radio" value="有意者请与我联系" id="pde1" name="pde" onclick="setDetails(this)">有需要者请联系</label>
    				<label class="radio"><input type="radio" value="具体情况联系详谈" id="pde2" name="pde" onclick="setDetails(this)">具体情况联系详谈</label>
    				<label class="radio"><input type="radio" value="愿与新老客户建立良好合作关系" id="pde3" name="pde" onclick="setDetails(this)" class="radioPositionFix">愿与新老客户建立良好合作关系</label>
    				<br />
					<label class="radio"><input type="radio" value="欢迎有货者与我联系" name="pde" id="pde4" onclick="setDetails(this)">欢迎有货者与我联系</label>
    				<label class="radio"><input type="radio" value="欢迎来电垂询,详谈" name="pde" id="pde5" onclick="setDetails(this)">欢迎来电垂询,详谈</label>
                </p>
            </div>
		</div>
		
		<div class="control-group">
			<label class="control-label">
				<span class="red">*</span>信息有效期：
			</label>
			<div class="controls">
				<label class="radio"><input type='radio' name='postlimittime' value='365' />长期有效(一年内有效)</label>
				<label class="radio"><input type='radio' name='postlimittime' value='90' />3个月</label>
				<label class="radio"><input type='radio' name='postlimittime' value='30' />1个月</label>
				<label class="radio"><input type='radio' name='postlimittime' value='20' checked />20天</label>
				<label class="radio"><input type='radio' name='postlimittime' value='10' />10天</label>
			</div>
		</div>

		<div class="control-group">
			<div class="control-label"></div>
			<div class="controls">
				<input name="verifyCodeKey" id="verifyCodeKey" type="hidden">
				<input name="verifyCode" id="verifyCode" class="field input-small" type="text" />
				<img id='codeImg' src='$!{address.img}/front/images/global/loading.gif' class="image3" width="100" height="28" title="看不清楚?点击图刷新验证码！" style="cursor:pointer;vertical-align:middle" />
				<span class="textcolor2" id="changImg">看不清楚?换一张。</span>
				<p><strong class="red">请将上方图片里显示的信息填入框中。</strong></p>
			</div>
		</div>

		<div class="form-actions">
			<input type="submit" id="submitBtn" class="btn btn-primary" value="发布信息"/>
			<span id="noMore" class="hidden">您发布信息太频繁，请稍后再发！</span>
		</div>
		<input type="hidden" name="provideStatus" checked value="$!{provideStatus}"/>
		<input type="hidden" name="ypStatus" checked value="$!{ypStatus}"/>
		<input type="hidden" name="pubKey" value="$!{pubKey}" />
		<!--产品图片限制5张-->
		<input type="hidden" id="limitCount" name="limitCount" value="5" />
		
		<input type="hidden" id="textPhoto" name="textPhoto" value="" />
		<!--描述里的图片-->
		<input type="hidden" id="textPhoto" name="titlePhoto" value="" />
		## 星级分数
		<input type="hidden" id ="score" name="score" value="" />
	</form>
</div>

#parse("/common/importValidate.vm")

<script type="text/javascript">
	## ckeditor定义
	var ckeditor
	jQuery(document).ready(function() {
	
		if(!+[1,]){
			ckeditor = {
				getData : function(){
					return jQuery("#content").val();
				},
				insertHtml : function(img){
					jQuery("#content").val(jQuery("#content").val()+img);
				}
			}
			jQuery("#content").change(function(){
				starCount();
			});
			jQuery("#content").blur(function(){
				starCount();
			});
			jQuery("#content").mouseleave(function(){
				starCount();
			});
		}else{
    		ckeditor=CKEDITOR.replace("content",{
    			toolbar:[
    					 ['Bold','Italic','Underline','Strike','Outdent','Indent','-','NumberedList','BulletedList'],
    					 ['NumberedList','BulletedList'],
    					 ['JustifyLeft','JustifyCenter','JustifyRight','JustifyBlock'],['Maximize'],
    		   ],
               uiColor : '#fff',
               language : 'zh-cn',
    		   height:200,
    		   width :600,
    		   enterMode:CKEDITOR.ENTER_BR,
    		   shiftEnterMode:CKEDITOR.ENTER_P
    		});
    		
    		## 绑定事件
    		CKEDITOR.instances["content"].on("instanceReady", function () {  
                //set keyup event
                this.document.on("keyup", starCount);
                //and click event
                this.document.on("blur", starCount);
    			// set mouseleave event
    			this.document.on("mouseleave",starCount);
            });
		}
    });
	## ckeditor定义

    jQuery(function () {
    	
    	var typeCode = jQuery("#categoryProductsMainCode").val().substring(0, 4);
    	if (typeCode === "1001") {
    		jQuery("#useful_item").removeClass("hidden");
    		jQuery("#color_item").removeClass("hidden");
    		jQuery("#shape_item").removeClass("hidden");
    		jQuery("#level_item").removeClass("hidden");
    		jQuery("#appearance_item").removeClass("hidden");
    		jQuery("#impurity_item").removeClass("hidden");
    	} else if (typeCode === "1000") {
    		jQuery("#grade_item").removeClass("hidden");
    		jQuery("#shape_item").removeClass("hidden");
    		jQuery("#addProp_item").removeClass("hidden");
    	} else {
    		jQuery("#useful_item").removeClass("hidden");
    		jQuery("#impurity_item").removeClass("hidden");
    		jQuery("#addProp_item").removeClass("hidden");
    	}
    
        //菜单
    	jQuery(function(){
    	myrc.menu(2,1);	
    	})
    	jQuery(".uploadBtn").click(function(obj){
    		var id = jQuery(this).attr("id").replace("uploadBtn_", "");
    		var btn = jQuery(this);
    		if (btn.val() == "上传") {	
    			Asto.util.Callback.setSubmitCallback(function (success, data) {
    			    var ids=data.picId
    				var idArr=ids.split(",");
    				var paths=data.picAddress;
    				var pathArr=paths.split(",");
    				var t=0;
    				for(var i=1;i<idArr.length;i++){
    					for(var j=1;j<=5;j++){
    						var btn=jQuery("#uploadBtn_"+j)
    						if(btn.val()=="上传"){
    							t=j;
    							break;
    						}
    					}
    					if(t!=0){
    						var url = "delayPicChange('" + t + "','" + pathArr[i] + "')";
    						setTimeout(url, 2000);
    						jQuery("#previewId" + t).val(idArr[i]);
    						jQuery("#uploadBtn_"+t).val("删除");
    						jQuery('#picErrorContent').hide();
    					}
    				}
    				var num=Number(jQuery("#limitCount").val())-Number(idArr.length-1);
    				jQuery("#limitCount").val(num);
    				parent.closeoverlay();
					starCount();
    			});
    			var urls="$!{address.myrc}/photoabum/productsUpload.htm?destUrl=$!{address.myrc}/submitCallback.htm&albumId=3&limitCount=";
    			var url=urls+jQuery("#limitCount").val();
    			//将弹框关闭等字显示出来
    			parent.overtitle("上传图片");
    			openoverlay(url,'上传图片',700,500,0);
    		} else {
    			deletePic(btn, id);
    		}
    		
    	});
    
    	var previewImg = new Asto.util.PopupBox({
    		url: "#",
    		width: 850,
    		height: 450,
    		modal: true,
    		title: "大图预览"
    	});
    	jQuery(".upimgBlock img").click(function (e) {
    		previewImg.show(jQuery(this).attr("src"));
    	});
    	// 验证码
    	var imgCode = (function () {
    		var img = document.getElementById("codeImg");
    		var changeTime = function () {
    			img.src = "$!{address.front}/validationcode/vcode.htm?" + new Date();
    		}
    		changeTime();
    		jQuery(img).on("click", changeTime);
    		jQuery("#changImg").on("click", changeTime);
    	})();
    	// 单位
    	jQuery("input[name='quantityUnit']").on(
    		"change", function () {
    			jQuery("#Js_unit").text($(this).val());
    			if (this.getAttribute("id") === "myQuantityUnit") {
    				jQuery('#otherQuantity').removeClass("hidden");
    				jQuery("#otherU1").focus();
    			} else {
    				jQuery('#otherQuantity').addClass("hidden");
    				jQuery(this).parent().parent().parent().removeClass("error");
    			}
    		});
    
    	jQuery("#otherU1").on({
    		"blur": function () {
    				if (this.value === "") {
    					this.value = "吨";
    					jQuery(this).parent().parent().addClass("error");
    				} else {
    					jQuery(this).parent().parent().removeClass("error");
    				}
    				ortherInput('myQuantityUnit', this.value);
    				jQuery('#Js_unit').text(this.value);
    			},
    			"click": function () {
    				jQuery('#myQuantityUnit').attr('checked', true);
    			}
    	});
    
    	jQuery("input[name='priceUnit']").on("change", function () {
    		if (this.getAttribute("id") === "myPriceUnit") {
    			jQuery('#otherQuantityPrice').removeClass("hidden");
    			jQuery("#office_post_edit").focus();
    		} else {
    			jQuery('#otherQuantityPrice').addClass("hidden");
    			jQuery(this).parent().parent().parent().parent().removeClass("error");
    		}
    	});
    	jQuery("#otherUnit").on({
    		"blur": function () {
    				if (this.value === "") {
    					this.value = "元";
    					jQuery(this).parent().parent().parent().addClass("error");
    				} else {
    					jQuery(this).parent().parent().parent().removeClass("error");
    				}
    				ortherInput('myPriceUnit', this.value);
    			},
    			"click": function () {
    				jQuery('#myPriceUnit').attr('checked', true);
    			}
    	});
    	jQuery("#togglePrice").on("click", function () {
    		if (this.checked) {
    			jQuery('#priceFlag').show();
    		} else {
    			jQuery('#priceFlag').hide();
    		}
    	})
    
    	## 公开价格 填写价格
    	jQuery(".opPrice").click(function () {
    		var s = jQuery(":input[name='opPrice'][checked]").val();
    		if (s == 1) {
    			jQuery("#priceDetail").hide();
    			jQuery("#priceDetail2").hide();
    			jQuery("#minPrice").val("");
    			jQuery("#minPrice").validationEngine("hide");
    		} else {
    			jQuery("#priceDetail").show();
    			jQuery("#priceDetail2").show();
    		}
    	});
    
    	// 表单验证
    	jQuery("#editForm").validationEngine("attach");
    	
    	jQuery("#editForm").submit(function () {
    		var $property = $("input[name=property]");
    		var flg1 = 1;
    		for (var i = 0; i < $property.length; i++) {
    			if ($property.eq(i).val() === "属性") {
    
    				flg1 += 1;
    				if (flg1 > "2") {
    					$property.eq(i).parent().parent().find(".tag").html("*属性名不能为空!");
    					$property.eq(i).css("border-color", "#b94a48");
    				}
    			}
    		}
    		var $content = $("input[name=content]");
    		var flg2 = 1;
    		for (var i = 0; i < $content.length; i++) {
    
    			if ($content.eq(i).val() === "属性值") {
    
    				flg2 += 1;
    				if (flg2 >= "2") {
    					if ($content.eq(i).parent().parent().find(".tag").html() === "*属性名不能为空!") {
    						$content.eq(i).parent().parent().find(".tag").html("*属性名和属性值都不能为空!");
    						$content.eq(i).parent().parent().find("input[name=property]").css("border-color", "#b94a48");
    					} else {
    						$content.eq(i).parent().parent().find(".tag").html("*属性值不能为空!");
    					}
    					$content.eq(i).css("border-color", "#b94a48");
    				}
    			}
    		}
    		
    		for (var i = 0; i < $property.length; i++) {
    			if ($property.eq(i).parent().parent().find(".tag").html() != "") {
    				return false;
    			}
    		}
    		
    		## 样品信息 检验是否有上传图片
    		#if($!{ypStatus}==1&&$!{productsDO.productsTypeCode}=="10331000")
    		for(var i=0;i<5;i++){
    			if(jQuery("#previewId"+i).val()!=null&&jQuery("#previewId"+i).val()!=""){
    				break;
    			}
    			if(i==4){
    				jQuery("#previewId1").focus();
    				jQuery("#picErrorContent").show();
    				return false;
    			}
    		}
    		#end
    		
    		if (!jQuery("#editForm").validationEngine("validate")) {
    			return false;
    		} else {
    			var data=ckeditor.getData();
    			jQuery("#content").val(data);
    			var t=jQuery("#content").val();
    			jQuery.ajax({
    				type: "post",
    				url: "#springUrl('/myproducts/detailsTip.htm')",
    				data: {
    					 "details": jQuery("#content").val()
    				},
    				dataType: "json",
    				success: function (data) {
    					if(data.success){
    					  	//提交表单数据
    						jQuery.ajax({
    							url: "#springUrl('/myproducts/publishProducts.htm')",
    							data: jQuery("#editForm").serialize(),
    							cache: false,
    							dataType: "json",
    							type: "post",
    							success: function (req) {
    								if (req.success) {
    									//保存成功后给出提示 或 跳转到提示页面
    									window.location.href = "#springUrl('/myproducts/office_post_suc.htm?productId=')" + req.data.id;
    								} else {
    									if (req.data == "sessionTimeOut") {
    										window.open("$!{address.front}/login.htm");
    									}
    									if (req.data == "noMore") {
    										$("#noMore").show();
    									} else {
    										alert(req.data);
    									}
    									jQuery("#codeImg").attr("src", "$!{address.front}/validationcode/vcode.htm?" + new Date());
    								}
    							},
    							failure: function () {}
    							});
    						return false;
    					}else{
    						alert(data.data);
    					}
    				},
    				failure: function () {
    					Asto.util.Message.show({
    						msg: "发生错误，图片没有被删除，请过一会再试一下！",
    						msgType: Asto.util.Message.ERROR,
    						autoClose: 5000
    					});
    				}
    			});
    			return false;
    		}
    		return false;
    	});
    });

##组装供求详细

function appendDetail() {
	var detailStr = "$title";
	var quantity = jQuery("#quantity").val();
	if (quantity) {
		detailStr += "；$!{typename}数量" + quantity + jQuery(":input[name='quantityUnit'][checked]").val() + "左右";
	}
	var minPrice = jQuery("#minPrice").val();
	if (minPrice) {
		detailStr += "；大概报价" + minPrice;
		var maxPrice = jQuery("#maxPrice").val();
		if (maxPrice) {
			detailStr += " - " + maxPrice;
		}
		detailStr += jQuery(":input[name='priceUnit'][checked]").val() + "/" + jQuery(":input[name='quantityUnit'][checked]").val();
	} else {
		detailStr += "；价格面议"
	}
	var source = jQuery("#source").val();
	if (source) {
		detailStr += "；现在货在" + source;
	}
	var shipDay = jQuery("#shipDay").val();
	if (shipDay) {
		detailStr += "；大概" + shipDay + "天内可以发货";
	}
	detailStr += "。";
	var data=ckeditor.getData();
	
	if(!+[1,]){
		jQuery("#content").val(detailStr+data)
	}else{
		ckeditor.document.getBody().setHtml(detailStr+data);
	}
	
}

function deletePic(btn, id) {
	jQuery.ajax({
		type: "post",
		async:false,
		url: "#springUrl('/myproducts/deleteOnlyPic.htm')",
		data: {
			"id": jQuery("#previewId" + id).val()
		},
		dataType: "json",
		success: function (req) {
				jQuery("#previewImg" + id).attr("src", "$!{address.img}/front/images/global/noimage.gif");
				jQuery("#previewId" + id).val("");
				btn.val("上传");
				var num=Number(jQuery("#limitCount").val())+Number(1);
				jQuery("#limitCount").val(num);
				## 删除图片扣除积分
				var num = parseInt(jQuery("#num").html());
				num = num - 5;
				if(num<0){
					jQuery("#num").html(0);
				}else{
					jQuery("#num").html(num);
				}
			},
			failure: function () {
				Asto.util.Message.show({
					msg: "发生错误，图片没有被删除，请过一会再试一下！",
					msgType: Asto.util.Message.ERROR,
					autoClose: 5000
				});
			}
	});
}

function ortherInput(id, value) {
	jQuery("#" + id).val(value);
}

function chooseTags(id) {
	var tag = jQuery("#tags").val(),
		group = tag.split(","),
		atag = jQuery(".hotTags" + id).attr("title");
	for (var i in group) {
		if (group[i] === atag) {
			return false
		}
	}
	jQuery("#tags").val(tag + "," + atag);
}

function toggle(target) {
	target.toggle();
}
var oldStr = "";
var changeFlag = 0;

function setDetails(v) {
	var str=ckeditor.getData();
	var details=jQuery("#detailsStr").val();
	var count=details.length;
	var data="";
	var num=str.length;
		if(num>=(count)){
			var t=Number(num)-Number(count);
			var dataValue=str.substring(Number(num)-Number(count))
			var start =dataValue.indexOf(details)
			if(start==-1){
				var data=str+v.value;
			}else{
				var data=str.substring(0,Number(num)-Number(count))+v.value;
			}
		}else{
			var data=str+v.value;
		}
	if(!+[1,]){
		jQuery("#content").val(data);
	}else{
		ckeditor.document.getBody().setHtml(data);
	}
	jQuery("#detailsStr").val(v.value);
}
jQuery("#content").keyup(function () {
	changeFlag = 0;
});
jQuery(".cke_show_borders").click(function(){
	if(!+[1,]){
		jQuery("#content").val("")
	}else{
		ckeditor.document.getBody().setHtml("");
	}
})
## 现货物所在地
var regarea = new Asto.util.Selector({
	selects: ["#reg-area-0","#reg-area-1", "#reg-area-2"],
	assistSelects: ["#reg-garden"],
	url: "#springUrl('/category/areaChild.htm')",
	assistUrl: "#springUrl('/category/gardenChild.htm')",
	changeCallback: function (c, idx) {
		setAddress();
	}
});

regarea.init({
	rootCode: "1001"
});

## 组装地址

function setAddress() {
	var address = "";
	if (jQuery("#reg-area-0").val() != "") {
		address = address + jQuery("#reg-area-0").find("option:selected").text();
	}
	if (jQuery("#reg-area-1").val() != "") {
		address = address + jQuery("#reg-area-1").find("option:selected").text();
	}
	if (jQuery("#reg-area-2").val() != "") {
		address = address + jQuery("#reg-area-2").find("option:selected").text();
	}
	jQuery("#location").val(address);
}
    ## 判断最大价格
    
    function checkMaxPrice(field, rules, i, options) {
    	var min = parseInt(jQuery("#minPrice").val());
    	var max = parseInt(jQuery("#maxPrice").val());
    	if (min > 0 && max > 0 && min < max) {##
    		jQuery("#maxError").hide();
    	} else {
    		##jQuery("#maxError").html("<span>* 必须大于最小价格： " + min + "</span>")## jQuery("#maxError").show();
    		##var str = "<span>* 必须大于最小价格： " + min + "</span>"
    		##jQuery(".maxPriceformError").html("<div class='formErrorContent'><span>" + str + "</span></div>");
    		rules.push('required');
    		return "价格范围填写不正确";
    	}
    }

    function delayPicChange(id, address) {
    	jQuery("#previewImg" + id).attr("src", "$!{address.resource}/" + address);
    }
	function upload(){
		var htmlImg = ckeditor.getData();
		var imgAll=htmlImg.split("<img")
		if(imgAll.length<6){
			Asto.util.Callback.setSubmitCallback(function (success, data) {
				var paths=data.picAddress;
				var pathArr=paths.split(",");
				var t=0;
				for(var i=1;i<pathArr.length;i++){
					var img="<div width:700px;height:700px;overflow:hidden;><img src=\"$!{address.img3}/"+pathArr[i]+"\"/></div>";
					if(jQuery("#ckeditorFlag").val()==0){
						var html = ckeditor.getData();
        				ckeditor.document.getBody().setHtml(html+img);	
					}else{
						ckeditor.insertHtml(img);
					}
				}
					var num=Number(jQuery("#textPhoto").val())-Number(pathArr.length-1);
					jQuery("#textPhoto").val(num);
					setTimeout(url, 2000);
					parent.closeoverlay();
			});
			var limitCount=Number(5)-Number(imgAll.length)+Number(1);
			var urls="#springUrl('/photoabum/productsUpload.htm?destUrl=')$!{address.myrc}/submitCallback.htm&albumId=3&contextFlag=1&limitCount=";
			var url=urls+limitCount;
			parent.overtitle("上传图片");
			openoverlay(url,'上传图片',700,500,0);
			
		}
	};
	
	$(function(){
		//$('#editForm :input')获取的不仅有input[text]，还有最后的那个radio, raido默认的值为第一个option的值，
		//所以打开这个页面就最后一栏"radio"是默认有值状态
		$('#editForm :input').blur(function(){
			starCount();
        })
		$('#editForm :input').click(function(){
			starCount();
        })
		jQuery(".b-item1").blur(function(){
			starCount();
		});
	})


    $(function(){
    	$(".container").Sonline({
    		Position:"right",//left或right
    		Top:200,//顶部距离，默认200px
    		Effect:true, //滚动或者固定两种方式，布尔值：true或false
    		DefaultsOpen:true, //默认展开：true,默认收缩：false隔开
    		Qqlist:""
    	});
    })
    
    function bookmarks(obj) {
        var obj1 = $(obj).attr("action-data");
        var zuobiao = $("#" + obj1).offset().top - 60;
        $('body,html').animate({
            scrollTop: zuobiao + 'px'
        },
        "slow")
    }
    
    function countScore(str,score){
    	if(str!=""&&str!=undefined){
    		return score;
    	}
    	return 0;
    }
	
	##点亮
	function lightF(i){
		$(".tab-list a[action-data="+i+"F] span").css("color","#009944");
        $(".tab-list a[action-data="+i+"F] i").removeClass("gtick");
        $(".tab-list a[action-data="+i+"F] i").addClass("tick");
	}
	##点暗
	function greyF(i){
		$(".tab-list a[action-data="+i+"F] span").css("color","#9a9a9a");
		$(".tab-list a[action-data="+i+"F] i").removeClass("tick");
		$(".tab-list a[action-data="+i+"F] i").addClass("gtick");
	}

    function starCount(){
    	## 总分值
    	var cmpltnum = 0;
    	
    	## 完善交易条件点亮条件：必填产品名称、产品标签、供应数量、报价（需要填写价格，选择电议或者面议不加分且不点亮）
    	var title  		= $("#title").val();  										## 标题 5分
    	var tags 		= $("#tags").val(); 										## 标签 5分
    	var quantity 	= $("#quantity").val();										## 数量 5分
    	var minPrice 	= $("#minPrice").val();										## 报价 5分
    	## 判断点亮
    	if(title == "" || tags == "" || quantity == "" || minPrice == "" ){
    		$(".tab-list a[action-data=1F] span").css("color","#9a9a9a");
    		$(".tab-list a[action-data=1F] i").removeClass("tick");
    		$(".tab-list a[action-data=1F] i").addClass("gtick");
    	}else{
            $(".tab-list a[action-data=1F] span").css("color","#009944");
    		$(".tab-list a[action-data=1F] i").removeClass("gtick");
    		$(".tab-list a[action-data=1F] i").addClass("tick");
    	}
    	## 计算分值
    	cmpltnum = cmpltnum + countScore(title,5);
    	cmpltnum = cmpltnum + countScore(tags,5);
    	cmpltnum = cmpltnum + countScore(quantity,5);
    	cmpltnum = cmpltnum + countScore(minPrice,5);
    
		## 通用属性分值计算
		## 货源地 3分
    	var $source 	= $("#source").val();
		## 来源产品 3分
    	var $origin 	= $("#origin").val();
		## 产品规格 3分
    	var $specification = $("#specification").val();
		## 加工说明 3分
    	var manufacture = $("input[name='manufacture']:checked").val();
		cmpltnum = cmpltnum + countScore($source,3);
        cmpltnum = cmpltnum + countScore($origin,3);
        cmpltnum = cmpltnum + countScore($specification,3);
        cmpltnum = cmpltnum + countScore(manufacture,3);
		
		var typeCode = jQuery("#categoryProductsMainCode").val().substring(0, 4);
    	if (typeCode === "1001") {
			## 塑料分值计算
        	## 颜色 3分
        	var $color 		= $("#color").val();
        	## 形态 3分
        	var $shape 		= $("#shape").val();
        	## 级别 3分
        	var $level 		= $("#level").val();
        	## 外观 3分
        	var $appearance = $("#appearance").val();
        	## 此原料可用于 3分
        	var $useful 	= $("#useful").val();
        	## 杂质(杂物)含量 3分
        	var $impurity 	= $("#impurity").val();
			
			## 判断变色
        	if($color == "" || $shape == "" || $level == "" || $appearance == "" || $source == "" || $origin == "" || $specification == "" || $useful == "" || $impurity == ""|| manufacture == undefined){
				greyF(2);
        	}else{
				lightF(2);
        	}
    
    		## 计算分值
        	cmpltnum = cmpltnum + countScore($color,3);
        	cmpltnum = cmpltnum + countScore($shape,3);
        	cmpltnum = cmpltnum + countScore($level,3);
        	cmpltnum = cmpltnum + countScore($appearance,3);
        	cmpltnum = cmpltnum + countScore($useful,3);
        	cmpltnum = cmpltnum + countScore($impurity,3);
    	} else if (typeCode === "1000") {
			## 金属分值计算
			## 品位 3分
        	var grade = $("#grade").val();
			## 形态 3分
        	var $shape 		= $("#shape").val();
			
			## 判断变色
			if(grade == "" || $shape == "" || $source == "" || $origin == "" || $specification == "" || manufacture == undefined){
				greyF(2);
			}else{
				lightF(2);
			}
			
			## 计算分值
			cmpltnum = cmpltnum + countScore(grade,3);
			cmpltnum = cmpltnum + countScore($shape,3);
			
			var proScore = 0;
			jQuery("input[name='content']").each(function(){
				var proStr = jQuery(this).val();
				if(proStr!="属性值"&&proStr!=""){
					proScore = proScore + 3;
				}
			});
			if(proScore>12){
				proScore=12;
			}
			cmpltnum = cmpltnum + proScore;
			
    	} else {
			## 其他废料分值计算
			## 此原料可用于 3分
        	var $useful 	= $("#useful").val();
			## 杂质(杂物)含量 3分
        	var $impurity 	= $("#impurity").val();
			
			## 判断变色
        	if($source == "" || $origin == "" || $specification == "" || $useful == "" || $impurity == ""|| manufacture == undefined){
				greyF(2);
        	}else{
				lightF(2);
        	}
			
			## 计算分值
			cmpltnum = cmpltnum + countScore($useful,3);
        	cmpltnum = cmpltnum + countScore($impurity,3);
			
			## 附加属性分值计算
			var proScore = 0;
			jQuery("input[name='content']").each(function(){
				var proStr = jQuery(this).val();
				if(proStr!="属性值"&&proStr!=""){
					proScore = proScore + 3;
				}
			});
			if(proScore>12){
				proScore=12;
			}
			cmpltnum = cmpltnum + proScore;
    	}
		
		## 交易条件非必填 全填才有五分
		##交易说明
		var transaction = $("input[name='transaction']:checked").val();
		##发货时间
		var shipDay = jQuery("#shipDay").val();
		##现货所在地
		var location = jQuery("#location").val();
		
		if(jQuery("#transactionValue").is(':checked')){
    		var transactionArea = jQuery("#transactionArea").val();
			if(transactionArea !="" && shipDay !="" && location !=""){
				cmpltnum = cmpltnum + 5;
			}
		}else{
			if(transaction !=undefined && shipDay !="" && location !=""){
				cmpltnum = cmpltnum + 5;
			}
		}
		
    	## 检查是否有图片
		var pics = 0;
    	jQuery("input[name='picIds']").each(function(){
    		if(jQuery(this).val()>0){
    			cmpltnum = cmpltnum + 5;
 				pics = pics+1;
			}
    	});
		if(pics==0){
			greyF(3);
		}else{
			lightF(3);
		}
    
    	## 信息描述完整度 变色
    	var details=ckeditor.getData();
    	if(details == ""){
    		$(".tab-list a[action-data=4F] span").css("color","#9a9a9a");
    		$(".tab-list a[action-data=4F] i").removeClass("tick");
    		$(".tab-list a[action-data=4F] i").addClass("gtick");
    	}else{
			jQuery.ajax({
				url:"#springUrl('/myproducts/validteDetailsScore.htm')",
				data:{str:details},
				async:false,
				type:"POST",
				dataType:"json",
				success:function(data){
					cmpltnum = cmpltnum + data.score;
					if(data.cnLength>=30){
						lightF(4);
					}else{
						greyF(4);
					}
				}
			})
    	}
    	
    	var cmprate = cmpltnum;
    	$('#num').html(''+cmpltnum);
    	if(cmprate >= 0 && cmprate < 10){
    		$('#cmpltlvl').attr('class', 'lv0');
    	}else if(cmprate >= 10 && cmprate < 20){
    		$('#cmpltlvl').attr('class', 'lv0');
    	}else if(cmprate >= 20 && cmprate < 30){
    		$('#cmpltlvl').attr('class', 'lv1');
    	}else if(cmprate >= 30 && cmprate < 40){
    		$('#cmpltlvl').attr('class', 'lv1');
    	}else if(cmprate >= 40 && cmprate < 50){
    		$('#cmpltlvl').attr('class', 'lv2');
    	}else if(cmprate >= 50 && cmprate < 60){
    		$('#cmpltlvl').attr('class', 'lv2');
    	}else if(cmprate >= 60 && cmprate < 70){
    		$('#cmpltlvl').attr('class', 'lv3');
    	}else if(cmprate >= 70 && cmprate < 80){
    		$('#cmpltlvl').attr('class', 'lv3');
    	}else if(cmprate >= 80 && cmprate < 90){
    		$('#cmpltlvl').attr('class', 'lv4');
    	}else if(cmprate >= 90 && cmprate < 100){
    		$('#cmpltlvl').attr('class', 'lv4');
    	}else if(cmprate >= 100){
    		$('#cmpltlvl').attr('class', 'lv5');
    	}
		
		jQuery("#score").val(cmpltnum);
		
    }
	
</script>