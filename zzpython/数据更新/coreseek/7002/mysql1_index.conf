#源定义  ---- 公司库索引
source company
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= ast
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT a.id,a.name,a.name as compname,a.business,a.business as pbusiness,a.service_code,\
						a.industry_code,a.area_code,length(a.area_code) as area_code_length,a.foreign_city,a.category_garden_id,\
						a.membership_code,a.regfrom_code,a.is_block,UNIX_TIMESTAMP(a.regtime) as regtime,UNIX_TIMESTAMP(a.gmt_created) as gmt_created,\
						a.address,a.address as paddress,a.sale_details,a.buy_details,a.tags,b.label as area_name,c.label as area_province,c.label as parea_province,a.domain_zz91, \
						UNIX_TIMESTAMP(d.gmt_start) as gmt_start,d.apply_status,pinyin(left(a.name,1)) as pinyin,e.mobile_order \
						FROM company as a \
						left OUTER join category as b on b.code=a.area_code \
						left outer join category as c on b.parent_code=c.code \
						left outer join crm_company_service as d on d.company_id=a.id and d.apply_status = '1'\
						left outer join crm_service as e on e.code=d.crm_service_code \
						where a.is_block ='0' and not exists(select id from company_hide where company_id=a.id)
	sql_attr_uint			= industry_code #从SQL读取到的值必须为整数
	sql_attr_uint			= area_code_length
	sql_attr_uint			= category_garden_id
	sql_attr_uint			= membership_code
	sql_attr_uint			= gmt_start
	sql_attr_uint			= regtime
	sql_attr_uint			= apply_status
	sql_attr_uint			= service_code
	sql_attr_uint			= mobile_order
	sql_attr_string			= compname
	sql_attr_string			= pbusiness
	sql_attr_string			= parea_province
	sql_attr_string			= domain_zz91
	sql_attr_string			= paddress
}
#index定义
index company
{
	source			= company             #对应的source名称
	path			= /mnt/coreseek/var/data/company_java
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}
#源定义  ---- 供求类别
source category_products
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= ast
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT id,code,label,search_label,code as pcode,label as plabel,is_assist,sort,search_label as psearch_label,pinyin(left(label,1)) as pinyin FROM category_products where is_del='0' 
	sql_attr_string			= pcode		#从SQL读取到的值必须为整数
	sql_attr_string			= plabel
	sql_attr_string                 = psearch_label
}
#index定义
index category_products
{
	source			= category_products             #对应的source名称
	path			= /mnt/coreseek/var/data/category_products
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}

source category_products_new
{
        type                            = mysql
        sql_host                        = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
        sql_user                        = ast
        sql_pass                        = astozz91jiubao
        sql_db                          = ast
        sql_port                        = 3306
        sql_query_pre                   = SET NAMES utf8
        sql_query_pre                   = SET SESSION query_cache_type=OFF
        sql_query                       = SELECT code,label,search_label,code as pcode,label as plabel,is_assist,sort,search_label as psearch_label,pinyin(left(label,1)) as pinyin FROM category_products where is_del='0'
        sql_attr_string                 = pcode         #从SQL读取到的值必须为整数
        sql_attr_string                 = plabel
        sql_attr_string                 = psearch_label
}
#index定义
index category_products_new
{
        source                  = category_products_new             #对应的source名称
        path                    = /mnt/coreseek/var/data/category_products_new
        docinfo                 = extern
        mlock                   = 0
        morphology              = none
        min_word_len            = 1
        html_strip                              = 0
        charset_dictpath = /usr/local/mmseg3/etc/    #BSD、Linux环境下设置，/符号结尾
        charset_type            = zh_cn.utf-8
}


#源定义  ---- 互助索引
source huzhu
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= ast
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	#sql_query_pre 		= REPLACE INTO counter1 SELECT 4,UNIX_TIMESTAMP(MAX(gmt_modified)) FROM bbs_post where is_del='0' and not exists(select id from company where bbs_post.company_id = id and is_block ='1')
	sql_query			= SELECT id,id as pid,bbs_user_profiler_id,bbs_post_category_id,bbs_post_assist_id,title,title as ptitle,DATE_FORMAT(post_time,'%Y-%m-%d') as ppost_time,UNIX_TIMESTAMP(post_time) as post_time,UNIX_TIMESTAMP(reply_time) as reply_time,UNIX_TIMESTAMP(gmt_created) as gmt_created,UNIX_TIMESTAMP(gmt_modified) as gmt_modified,tags,pinyin(left(title,1)) as pinyin,content_query,reply_count,visited_count,check_status,is_del,tags,category,notice_count,post_type FROM bbs_post where check_status=1 and is_del=0 and not exists(select id from company where bbs_post.company_id = id and is_block ='1') 
	sql_attr_uint       = pid
	sql_attr_uint		= bbs_user_profiler_id		
	sql_attr_uint		= bbs_post_category_id
    sql_attr_uint       = bbs_post_assist_id
    sql_attr_uint       = notice_count
    sql_attr_uint       = post_type
	sql_attr_uint		= post_time
    sql_attr_uint       = gmt_modified
	sql_attr_uint		= is_del
	sql_attr_uint       = reply_time
	sql_attr_uint       = reply_count
	sql_attr_uint       = visited_count
	sql_attr_uint       = check_status
	sql_attr_string		= ptitle
	sql_attr_string		= ppost_time
}

#index定义
index huzhu
{
	source			= huzhu             #对应的source名称
	path		 	= /mnt/coreseek/var/data/huzhu
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}
source delta_huzhu:huzhu
{
	sql_ranged_throttle = 100
	sql_query_pre		= SET NAMES utf8
	sql_query			= SELECT id,id as pid,bbs_user_profiler_id,bbs_post_category_id,bbs_post_assist_id,title,title as ptitle,DATE_FORMAT(post_time,'%Y-%m-%d') as ppost_time,UNIX_TIMESTAMP(post_time) as post_time,UNIX_TIMESTAMP(reply_time) as reply_time,UNIX_TIMESTAMP(gmt_created) as gmt_created,UNIX_TIMESTAMP(gmt_modified) as gmt_modified,tags,pinyin(left(title,1)) as pinyin,content_query,reply_count,visited_count,check_status,is_del,tags,category,notice_count,post_type FROM bbs_post where check_status=1 and not exists(select id from company where bbs_post.company_id = id and is_block ='1') and is_del=0 and UNIX_TIMESTAMP(gmt_modified)>( SELECT max_doc_id FROM counter1 WHERE id=4)
	#sql_query_post 		= REPLACE INTO counter1 SELECT 4,UNIX_TIMESTAMP(MAX(gmt_modified)) FROM bbs_post where is_del=0 and not exists(select id from company where bbs_post.company_id = id and is_block ='1')
	sql_attr_uint       = pid
	sql_attr_uint		= bbs_user_profiler_id		
	sql_attr_uint		= bbs_post_category_id
    sql_attr_uint       = bbs_post_assist_id
    sql_attr_uint       = notice_count
    sql_attr_uint       = post_type
	sql_attr_uint		= post_time
    sql_attr_uint       = gmt_modified
	sql_attr_uint		= is_del
	sql_attr_uint       = reply_time
	sql_attr_uint       = reply_count
	sql_attr_uint       = visited_count
	sql_attr_uint       = check_status
	sql_attr_string		= ptitle
	sql_attr_string		= ppost_time
}
index delta_huzhu
{
	source			= delta_huzhu             #对应的source名称
	path			= /mnt/coreseek/var/data/delta_huzhu
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}
#源定义  ---- 互助索引
source huzhureply
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= ast
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT id,bbs_post_id,title,title as ptitle,DATE_FORMAT(gmt_created,'%Y-%m-%d') as ppost_time,UNIX_TIMESTAMP(gmt_created) as post_time,UNIX_TIMESTAMP(gmt_created) as gmt_created,check_status FROM bbs_post_reply where is_del='0'
	sql_attr_uint		= bbs_post_id		#从SQL读取到的值必须为整数
	sql_attr_uint		= post_time
	sql_attr_uint       = check_status
	sql_attr_string		= ptitle
	sql_attr_string		= ppost_time
}
#index定义
index huzhureply
{
	source			= huzhureply             #对应的source名称
	path			= /mnt/coreseek/var/data/huzhureply
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}
#源定义  ----关键字索引
source keywordsearch
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= ast
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT id,keyword,searchCount,searchCount as scount FROM category_keywords_search
	sql_attr_uint		= searchCount
}
#index定义
index keywordsearch
{
	source			= keywordsearch             #对应的source名称
	path			= /mnt/coreseek/var/data/keywordsearch
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}
#源定义  ----询盘索引
source question
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= ast
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	#sql_query_pre 		= REPLACE INTO counter1 SELECT 3,MAX(id) FROM inquiry
	sql_query			= SELECT a.id,a.id as qid,a.title,a.is_viewed,b.company_id as scomid,c.company_id as rcomid,a.be_inquired_id,a.be_inquired_type FROM inquiry as a LEFT JOIN company_account as b ON a.sender_account=b.account LEFT JOIN company_account as c ON a.receiver_account=c.account and a.is_sender_del=0 and a.is_receiver_del=0 \
							where a.id<=( SELECT max_doc_id FROM counter1 WHERE id=3)
	sql_attr_uint		= qid
	sql_attr_uint		= scomid
	sql_attr_uint		= rcomid
	sql_attr_uint       = is_viewed
}
#index定义
index question
{
	source			= question             #对应的source名称
	path			= /mnt/coreseek/var/data/question
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}
source delta_question:question
{
	sql_ranged_throttle = 100
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT a.id,a.id as qid,a.title,a.is_viewed,b.company_id as scomid,c.company_id as rcomid,a.be_inquired_id,a.be_inquired_type FROM inquiry as a LEFT JOIN company_account as b ON a.sender_account=b.account LEFT JOIN company_account as c ON a.receiver_account=c.account and a.is_sender_del=0 and a.is_receiver_del=0 \
							where a.id>( SELECT max_doc_id FROM counter1 WHERE id=3)
	#sql_query_post 		= REPLACE INTO counter1 SELECT 3,max(id) FROM inquiry
	sql_attr_uint		= qid
	sql_attr_uint		= scomid
	sql_attr_uint		= rcomid
	sql_attr_uint       = is_viewed
}
index delta_question:question
{
	source			  = delta_question             #对应的source名称
	path			  = /mnt/coreseek/var/data/question_p
	docinfo			  = extern
	mlock			  = 0
	morphology		  = none
	min_word_len	  = 1
	html_strip		  = 0
	charset_dictpath  = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type	  = zh_cn.utf-8
}
#源定义  ----标签索引
source tagslist
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= zztags
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT a.id,a.id as tid,a.tags,a.tags as tname,a.search_count,a.click_count,pinyin(left(a.tags,1)) as pinyin,b.category_products_main_code,left(b.category_products_main_code,4) as main_code1,left(b.category_products_main_code,4) as main_code,left(b.category_products_main_code,8) as main_code2,left(b.category_products_main_code,12) as main_code3,b.pingyin FROM tags as a left join tags_category as b on a.id=b.tags_id where a.closeflag=0
	sql_attr_uint		= tid
	sql_attr_uint		= search_count
	sql_attr_uint       = click_count
	sql_attr_uint		= main_code
	sql_attr_string		= tags
	sql_attr_string		= pingyin
	
}
#index定义
index tagslist
{
	source			= tagslist             #对应的source名称
	path			= /mnt/coreseek/var/data/tagslist
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}


#源定义  ----供求索引_new
source offersearch_new
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= ast
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	#sql_query_pre 		= REPLACE INTO counter1 SELECT 1,UNIX_TIMESTAMP(MAX(gmt_modified)) FROM products
	sql_query			= SELECT p.id, p.company_id,UNIX_TIMESTAMP(DATE_FORMAT(p.refresh_time,'%Y-%m-%d')) as pdt_date,DATEDIFF(CURDATE(),p.refresh_time) as Prodatediff, right(p.products_type_code,1) as pdt_kind, p.title, p.title as ptitle,  c.label AS label0, c1.label AS label1, c2.label AS label2, c3.label AS label3, c4.label AS label4,e.label as city,f.label as province,g.viptype,g.viptype_ldb, UNIX_TIMESTAMP( p.refresh_time ) AS refresh_time, p.expire_time, p.price,length(p.price) as length_price,length(p.min_price) as haveprice ,p.min_price, length(h.id) as havepic ,p.quantity, p.tags,p.check_status,p.is_del,j.crm_service_code,k.label as countryname,pinyin(left(p.title,1)) as pinyin,p.is_pause,p.color,n.properties as properties,length(m.id) as havesample,m.is_del as sampleDel,m.amount,m.take_price , m.send_price,o.phone_rate  \
	FROM products AS p LEFT OUTER JOIN category_products AS c on p.category_products_main_code = c.code \
	LEFT OUTER JOIN category_products AS c1 on LEFT(p.category_products_main_code, 4) = c1.code \
	LEFT OUTER JOIN category_products AS c2 on LEFT(p.category_products_main_code, 8) = c2.code \
	LEFT OUTER JOIN category_products AS c3 ON LEFT(p.category_products_main_code, 12) = c3.code \
	LEFT OUTER JOIN category_products AS c4 ON p.category_products_assist_code = c4.code and c4.is_assist=1 \
	LEFT OUTER JOIN company as d ON p.company_id=d.id \
	LEFT OUTER JOIN category as e ON left(d.area_code,16)=e.code \
	LEFT OUTER JOIN category as f ON left(d.area_code,12)=f.code \
	LEFT OUTER JOIN category as k ON left(d.area_code,8)=k.code \
	LEFT OUTER JOIN category as g ON d.membership_code=g.code \
	LEFT OUTER JOIN products_pic as h ON p.id=h.product_id and h.check_status=1 \
	LEFT OUTER JOIN crm_company_service as j ON j.company_id=p.company_id \
	LEFT OUTER JOIN sample_relate_product as l on l.product_id = p.id \
    LEFT OUTER JOIN sample as m on m.id = l.sample_id \
	LEFT OUTER JOIN products_properties as n on n.products_id = p.id \
	LEFT OUTER JOIN ldb_level as o ON o.company_id=p.company_id \
	WHERE p.is_del =0 \
	AND p.check_status ='1' \
	AND p.is_pause =0 \
	and p.id not in(SELECT p1.id \
	FROM products AS p1 \
	LEFT OUTER JOIN company as d1 ON p1.company_id=d1.id \
	LEFT OUTER JOIN category as g1 ON d1.membership_code=g1.code \
	WHERE p1.is_del ='0' \
	AND p1.check_status ='1' \
	AND p1.is_pause ='0' \
	AND DATEDIFF(CURDATE(),p1.refresh_time)<=3 \
	AND g1.viptype>=1) \
 	AND not exists(select id from company where p.company_id = id and is_block ='1') \
	AND not exists(select product_id from products_hide where p.id = product_id)
	sql_attr_uint		= company_id
	sql_attr_uint		= pdt_date
	sql_attr_uint		= refresh_time
	sql_attr_uint		= pdt_kind
	sql_attr_uint		= havepic
	sql_attr_uint		= havesample
	sql_attr_uint		= sampleDel
	sql_attr_uint		= length_price
	sql_attr_uint		= haveprice
	sql_attr_uint		= viptype
	sql_attr_uint		= viptype_ldb
	sql_attr_uint		= Prodatediff
	sql_attr_uint		= check_status
	sql_attr_uint		= is_del
	sql_attr_uint		= crm_service_code
	sql_attr_uint		= is_pause
	sql_attr_uint		= amount
	sql_attr_uint       = min_price
	sql_attr_float		= take_price 
	sql_attr_float		= send_price
	sql_attr_float		= phone_rate
	sql_attr_string		= ptitle
    sql_attr_uint       = quantity
	
}
#index定义
index offersearch_new
{
	source			= offersearch_new             #对应的source名称
	path			= /mnt/coreseek/var/data/offersearch_new
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}
source delta_offersearch:offersearch_new
{
	sql_ranged_throttle = 100
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT p.id, p.company_id,p.pdt_date,p.Prodatediff, p.pdt_kind, p.title, p.title as ptitle, p.label0, p.label1, p.label2, p.label3, p.label4,p.city,p.province,p.viptype,p.viptype_ldb, p.refresh_time, p.expire_time, p.price,p.length_price,p.haveprice,p.min_price,p.havepic,p.quantity, p.tags,p.check_status,p.is_del,p.crm_service_code,p.countryname,p.pinyin,p.is_pause,p.color,p.properties,p.havesample,p.sampleDel,p.amount,p.take_price , p.send_price,p.phone_rate \
	FROM products_s as p where p.viptype<1 \
	AND UNIX_TIMESTAMP(p.gmt_modified)>( SELECT max_doc_id FROM counter1 WHERE id=1) \
	AND not exists(select id from company where p.company_id = id and is_block ='1') \
	AND not exists(select product_id from products_hide where p.id = product_id)
	sql_attr_uint		= company_id
	sql_attr_uint		= pdt_date
	sql_attr_uint		= refresh_time
	sql_attr_uint		= pdt_kind
	sql_attr_uint		= havepic
	sql_attr_uint		= havesample
	sql_attr_uint		= sampleDel
	sql_attr_uint		= length_price
	sql_attr_uint		= haveprice
	sql_attr_uint		= viptype
	sql_attr_uint		= viptype_ldb
	sql_attr_uint		= Prodatediff
	sql_attr_uint		= check_status
	sql_attr_uint		= is_del
	sql_attr_uint		= crm_service_code
	sql_attr_uint		= is_pause
	sql_attr_uint		= amount
	sql_attr_uint       = min_price
	sql_attr_float		= take_price 
	sql_attr_float		= send_price
	sql_attr_float		= phone_rate
	sql_attr_string		= ptitle
    sql_attr_uint       = quantity
}
index delta_offersearch:offersearch_new
{
	source			= delta_offersearch             #对应的source名称
	path			= /mnt/coreseek/var/data/delta_offersearch
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}
source delta_offersearch_vip:offersearch_new
{
	sql_ranged_throttle = 100
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT p.id, p.company_id,p.pdt_date,p.Prodatediff, p.pdt_kind, p.title, p.title as ptitle, p.label0, p.label1, p.label2, p.label3, p.label4,p.city,p.province,p.viptype,p.viptype_ldb, p.refresh_time, p.expire_time, p.price,p.length_price,p.haveprice,p.min_price,p.havepic,p.quantity, p.tags,p.check_status,p.is_del,p.crm_service_code,p.countryname,p.pinyin,p.is_pause,p.color,p.properties,p.havesample,p.sampleDel,p.amount,p.take_price , p.send_price,p.phone_rate \
	FROM products_s as p where p.viptype>=1 and DATEDIFF(CURDATE(),p.refresh_time1)>3 \
	AND UNIX_TIMESTAMP(p.gmt_modified)>(SELECT max_doc_id FROM counter1 WHERE id=1) \
	AND not exists(select id from company where p.company_id = id and is_block ='1') \
	AND not exists(select product_id from products_hide where p.id = product_id)
	sql_attr_uint		= company_id
	sql_attr_uint		= pdt_date
	sql_attr_uint		= refresh_time
	sql_attr_uint		= pdt_kind
	sql_attr_uint		= havepic
	sql_attr_uint		= havesample
	sql_attr_uint		= sampleDel
	sql_attr_uint		= length_price
	sql_attr_uint		= haveprice
	sql_attr_uint		= viptype
	sql_attr_uint		= viptype_ldb
	sql_attr_uint		= Prodatediff
	sql_attr_uint		= check_status
	sql_attr_uint		= is_del
	sql_attr_uint		= crm_service_code
	sql_attr_uint		= is_pause
	sql_attr_uint		= amount
	sql_attr_uint       = min_price
	sql_attr_float		= take_price 
	sql_attr_float		= send_price
	sql_attr_float		= phone_rate
	sql_attr_string		= ptitle
    sql_attr_uint       = quantity
}


index delta_offersearch_vip:offersearch_new
{
	source			= delta_offersearch_vip             #对应的source名称
	path			= /mnt/coreseek/var/data/delta_offersearch_vip
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}



#源定义  ----供求索引_new_vip 高会
source offersearch_new_vip
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= ast
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT p.id, p.company_id,p.pdt_date,p.Prodatediff, p.pdt_kind, p.title, p.title as ptitle, p.label0, p.label1, p.label2, p.label3, p.label4,p.city,p.province,p.viptype,p.viptype_ldb, p.refresh_time, p.expire_time, p.price,p.length_price,p.haveprice,p.min_price,p.havepic,p.quantity, p.tags,p.check_status,p.is_del,p.crm_service_code,p.countryname,p.pinyin,p.is_pause,p.color,p.properties,p.havesample,p.sampleDel,p.amount,p.take_price , p.send_price,p.phone_rate,p.phone_level,p.phone_cost,p.phone_num  \
	FROM products_s as p where p.viptype>=1 and p.is_del =0 and p.check_status =1 and p.is_pause =0 and DATEDIFF(CURDATE(),p.refresh_time1)<=3\
	AND not exists(select id from company where p.company_id = id and is_block ='1') \
	AND not exists(select product_id from products_hide where p.id = product_id)

	sql_attr_uint		= company_id
	sql_attr_uint		= pdt_date
	sql_attr_uint		= refresh_time
	sql_attr_uint		= pdt_kind
	sql_attr_uint		= havepic
	sql_attr_uint		= havesample
	sql_attr_uint		= sampleDel
	sql_attr_uint		= length_price
	sql_attr_uint		= haveprice
	sql_attr_uint		= viptype
	sql_attr_uint		= viptype_ldb
	sql_attr_uint		= Prodatediff
	sql_attr_uint		= check_status
	sql_attr_uint		= is_del
	sql_attr_uint		= crm_service_code
	sql_attr_uint		= is_pause
	sql_attr_uint		= amount
	sql_attr_uint       = min_price
	sql_attr_float		= take_price 
	sql_attr_float		= send_price
	sql_attr_float		= phone_rate
	sql_attr_float		= phone_level
	sql_attr_uint		= phone_num
	sql_attr_float      = phone_cost
	sql_attr_string		= ptitle
    sql_attr_uint       = quantity
}
#index定义
index offersearch_new_vip
{
	source			= offersearch_new_vip             #对应的source名称
	path			= /mnt/coreseek/var/data/offersearch_new_vip
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}

#源定义  ----供求索引_来电宝
source offersearch_ppc
{
	type				= mysql
	sql_host			= rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_user			= ast
	sql_pass			= astozz91jiubao
	sql_db				= ast
	sql_port			= 3306
	sql_query_pre		= SET NAMES utf8
	sql_query_pre       = SET SESSION query_cache_type=OFF
	sql_query			= SELECT p.id, p.company_id,UNIX_TIMESTAMP(DATE_FORMAT(p.refresh_time,'%Y-%m-%d')) as pdt_date,DATEDIFF(CURDATE(),p.refresh_time) as Prodatediff, \
	right(p.products_type_code,1) as pdt_kind, d.name as companyname,p.title, p.title as ptitle, c.label AS label0, c1.label AS label1, c2.label AS label2, c3.label AS label3, c4.label AS label4,\
	e.label as city,f.label as province,g.viptype, UNIX_TIMESTAMP( p.refresh_time ) AS refresh_time, p.expire_time, p.price,length(p.price) as length_price, length(h.id) as havepic,length(p.min_price) as haveprice, p.min_price,\
	p.tags,p.check_status,p.is_pause,p.is_del,k.label as countryname,pinyin(left(p.title,1)) as pinyin,j.keywords as ppckeywords,j.front_tel ,p.color,n.properties as properties,length(m.id) as havesample,m.is_del as sampleDel,m.amount,m.take_price , m.send_price,j.sort,o.phone_rate  \
	FROM products AS p LEFT OUTER JOIN category_products AS c on p.category_products_main_code = c.code \
	LEFT OUTER JOIN category_products AS c1 on LEFT(p.category_products_main_code, 4) = c1.code \
	LEFT OUTER JOIN category_products AS c2 on LEFT(p.category_products_main_code, 8) = c2.code \
	LEFT OUTER JOIN category_products AS c3 ON LEFT(p.category_products_main_code, 12) = c3.code \
	LEFT OUTER JOIN category_products AS c4 ON p.category_products_assist_code = c4.code and c4.is_assist=1 \
	LEFT OUTER JOIN company as d ON p.company_id=d.id \
	LEFT OUTER JOIN category as e ON left(d.area_code,16)=e.code \
	LEFT OUTER JOIN category as f ON left(d.area_code,12)=f.code \
	LEFT OUTER JOIN category as k ON left(d.area_code,8)=k.code \
	LEFT OUTER JOIN category as g ON d.membership_code=g.code \
	LEFT OUTER JOIN products_pic as h ON p.id=h.product_id  and h.check_status=1 \
	LEFT OUTER JOIN phone as j ON p.company_id=j.company_id \
	LEFT OUTER JOIN sample_relate_product as l on l.product_id = p.id \
    LEFT OUTER JOIN sample as m on m.id = l.sample_id \
	LEFT OUTER JOIN products_properties as n on n.products_id = p.id \
	LEFT OUTER JOIN ldb_level as o ON o.company_id=p.company_id \
	WHERE p.is_del ='0' and g.viptype>=1 \
	AND is_pause ='0' \
	AND exists(select company_id from phone where p.company_id = company_id) \
	AND exists(select company_id from crm_company_service where p.company_id = company_id and crm_service_code in ('1007','1008','1009','1010') and apply_status=1) \
	and exists(select company_id from phone_cost_service where lave>0 and is_lack=0 and p.company_id = company_id) \
	AND not exists(select product_id from products_hide where p.id = product_id)

	sql_attr_uint		= company_id
	sql_attr_uint		= pdt_date
	sql_attr_uint		= refresh_time
	sql_attr_uint		= pdt_kind
	sql_attr_uint		= havepic
	sql_attr_uint		= havesample
	sql_attr_uint		= sampleDel
	sql_attr_uint		= length_price
	sql_attr_uint		= haveprice
	sql_attr_uint		= viptype
	sql_attr_uint		= Prodatediff
	sql_attr_uint		= check_status
	sql_attr_uint		= is_del
	sql_attr_uint		= is_pause
	sql_attr_uint		= amount
	sql_attr_uint       = min_price
	sql_attr_uint		= sort
	sql_attr_float		= take_price 
	sql_attr_float		= send_price
	sql_attr_float		= phone_rate
	sql_attr_string		= ptitle
	sql_attr_string		= companyname
	sql_attr_string		= ppckeywords
	sql_attr_string		= front_tel
}
#index定义
index offersearch_ppc
{
	source			= offersearch_ppc            #对应的source名称
	path			= /mnt/coreseek/var/data/offersearch_ppc
	docinfo			= extern
	mlock			= 0
	morphology		= none
	min_word_len		= 1
	html_strip				= 0
	charset_dictpath = /usr/local/mmseg3/etc/	#BSD、Linux环境下设置，/符号结尾
	#charset_dictpath = etc/						#Windows环境下设置，/符号结尾
	charset_type		= zh_cn.utf-8
}


#导航索引
source daohangkeywords
{
	 type	 = mysql
	 sql_host	 = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	 sql_port	 = 3306
	 sql_user	 = ast
	 sql_pass	 = astozz91jiubao
	 sql_db	 = ast
	 sql_query_pre = SET NAMES utf8
	 sql_query	 = SELECT id,label,pingyin,label as plabel,pingyin as ppinyin,showcount FROM daohang
	 
	 sql_ranged_throttle	= 100
	 sql_query_info_pre = SET NAMES utf8
	 sql_attr_uint = showcount 
	 sql_attr_string = plabel
	 sql_attr_string = ppinyin
}
#index定义
index daohangkeywords
{
	source	 = daohangkeywords
	path	 = /mnt/coreseek/var/data/daohangkeywords
	docinfo	 = extern
	mlock	 = 0
	morphology	 = none
	min_word_len	= 1
	html_strip	 = 0

	charset_dictpath = /usr/local/mmseg3/etc/
	charset_type = utf-8
	charset_table = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F
	ngram_len = 1
	ngram_chars = U+3000..U+2FA1F
}

#登陆记录索引
source datalogin
{
	type	 = mysql
	sql_host	 = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_port	 = 3306
	sql_user	 = ast
	sql_pass	 = astozz91jiubao
	sql_db	     = ast
	sql_query_pre = SET NAMES utf8
	sql_query = SELECT id,company_id,company_id as pcompany_id,gmt_target,UNIX_TIMESTAMP(gmt_target) as pgmt_target,login_count,login_count as plogin_count FROM analysis_login

	sql_ranged_throttle = 100
	sql_query_info_pre = SET NAMES utf8
	sql_attr_uint = pcompany_id
	sql_attr_uint = pgmt_target
	sql_attr_uint = plogin_count
}
#index定义
index datalogin
{
	source	 = datalogin
	path	 = /mnt/coreseek/var/data/datalogin
	docinfo	 = extern
	mlock	 = 0
	morphology	 = none
	min_word_len	= 1
	html_strip	 = 0

	charset_dictpath = /usr/local/mmseg3/etc/
	charset_type = utf-8
	charset_table = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F
	ngram_len = 1
	ngram_chars = U+3000..U+2FA1F
}
#来电宝电话记录索引
source phone_log
{
	type	 = mysql
	sql_host	 = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
	sql_port	 = 3306
	sql_user	 = ast
	sql_pass	 = astozz91jiubao
	sql_db	     = ast
	sql_query_pre = SET NAMES utf8
	sql_query = SELECT a.id,a.caller_id,a.province,a.province as pprovince,a.city,a.city as pcity,a.tel,a.tel as ptel,a.call_fee,UNIX_TIMESTAMP(a.start_time) as pstart_time,HOUR(a.start_time) as hour_time,a.end_time,UNIX_TIMESTAMP(a.gmt_created) as pgmt_created,a.state,b.company_id FROM phone_log as a left join phone as b on a.tel=b.tel

	sql_ranged_throttle = 100
	sql_query_info_pre = SET NAMES utf8
	sql_attr_uint = company_id
	sql_attr_uint = caller_id
	sql_attr_string = pprovince
	sql_attr_string = pcity
	sql_attr_string = ptel
	sql_attr_string = call_fee
	sql_attr_string = pstart_time
	sql_attr_uint = hour_time
	sql_attr_string = state
	sql_attr_uint = pgmt_created
}
#index定义
index phone_log
{
	source	 = phone_log
	path	 = /mnt/coreseek/var/data/phone_log
	docinfo	 = extern
	mlock	 = 0
	morphology	 = none
	min_word_len	= 1
	html_strip	 = 0

	charset_dictpath = /usr/local/mmseg3/etc/
	charset_type = utf-8
	charset_table = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F
	ngram_len = 1
	ngram_chars = U+3000..U+2FA1F
}

# source 
source bbs_post_tags
{
        type     = mysql
        sql_host         = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
        sql_port         = 3306
        sql_user         = ast
        sql_pass         = astozz91jiubao
        sql_db       = ast
        sql_query_pre = SET NAMES utf8
        sql_query = SELECT a.id,a.category,a.tag_name,a.notice_count,a.article_count,a.mark,a.gmt_created,a.gmt_modified,b.name FROM  bbs_post_tags a left join bbs_post_categorys b on a.category = b.id
        sql_query_info_pre = SET NAMES utf8
        sql_attr_uint = id
}
# inded 
index bbs_post_tags
{
        source   = bbs_post_tags
        path     = /mnt/coreseek/var/data/bbs_post_tags
        docinfo  = extern
        mlock    = 0
        morphology       = none
        min_word_len    = 1
        html_strip       = 0

        charset_dictpath = /usr/local/mmseg3/etc/
        charset_type = utf-8
        charset_table = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F
        ngram_len = 1
        ngram_chars = U+3000..U+2FA1F
}
# source product_market
source product_market
{
      type             = mysql
      sql_host         = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
      sql_port         = 3306
      sql_user         = ast
      sql_pass         = astozz91jiubao
      sql_db           = ast
      sql_query_pre   = SET NAMES utf8
      sql_query        = SELECT pm.id,pm.product_id,pm.market_list,UNIX_TIMESTAMP(p.refresh_time) as refresh_time,c.membership_code,c.zst_year,p.category_products_main_code as main_code,p.products_type_code as type_code,p.is_del,p.is_pause,p.check_status,p.expire_time,g.viptype,left(p.category_products_main_code,4) as industry,left(p.category_products_main_code,8) as category,length(m.id) as havesample,m.is_del as sampleDel,left(c.area_code,12) as province,length(h.id) as havepic,p.company_id from product_market as pm \
      left OUTER join products as p on p.id=pm.product_id \
      left OUTER join company as c on c.id=p.company_id \
      left OUTER join category as g on g.code=c.membership_code\
      left OUTER join sample_relate_product as l on l.product_id = p.id \
      left OUTER join sample as m on m.id = l.sample_id \
      left OUTER JOIN products_pic as h ON p.id=h.product_id and h.check_status='1' \
      where c.is_block='0'
	  
      sql_attr_uint    = company_id
      sql_attr_string  = membership_code
	  sql_attr_uint    = product_id
      sql_attr_uint    = zst_year
      sql_attr_string  = main_code
     # sql_attr_string  = type_code
      sql_attr_uint    = is_del
      sql_attr_uint    = is_pause
      sql_attr_uint    = check_status
      sql_attr_uint    = expire_time
      sql_attr_uint    = refresh_time
      sql_attr_uint    = viptype
      sql_attr_uint    = havesample
      sql_attr_uint    = sampleDel
      sql_attr_uint    = havepic
}
#index product_market
index product_market
{
      source           = product_market
      path             = /mnt/coreseek/var/data/product_market
      docinfo          = extern
      mlock            = 0
      morphology       = none
      min_word_len     = 1
      html_strip       = 0

      charset_dictpath = /usr/local/mmseg3/etc/
      charset_type = utf-8
      charset_table = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F
      ngram_len = 1
      ngram_chars = U+3000..U+2FA1F
}
#source company_market
source company_market
{
     type             = mysql
      sql_host         = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
      sql_port         = 3306
      sql_user         = ast
      sql_pass         = astozz91jiubao
      sql_db           = ast
      sql_query_pre   = SET NAMES utf8
      sql_query        = SELECT mc.id, mc.market_id,mc.company_id,mc.product_num,mc.gmt_created,mc.is_quit,c.membership_code,c.zst_year,c.is_block,g.viptype \
               from market_company as mc \
               left OUTER join company as c on c.id=mc.company_id \
               left OUTER join category as g on g.code=c.membership_code
      sql_attr_uint    = company_id
      sql_attr_uint    = market_id
      sql_attr_uint    = gmt_created
      sql_attr_uint    = product_num
      sql_attr_uint    = viptype
      sql_attr_uint    = zst_year
      sql_attr_uint    = is_block
      sql_attr_uint    = is_quit
}
#index company_market
index company_market
{
      source           = company_market
      path             = /mnt/coreseek/var/data/company_market
      docinfo          = extern
      mlock            = 0
      morphology       = none
      min_word_len     = 1
      html_strip       = 0

      charset_dictpath = /usr/local/mmseg3/etc/
      charset_type = utf-8
      charset_table = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F
      ngram_len = 1
      ngram_chars = U+3000..U+2FA1F
}
#source market
source market
{
      type             = mysql
      sql_host         = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
      sql_port         = 3306
      sql_user         = ast
      sql_pass         = astozz91jiubao
      sql_db           = ast
      sql_query_pre   = SET NAMES utf8
      sql_query        = SELECT m.id,m.id as pid,m.name,m.name as pname,m.area,m.industry,m.category,m.business,m.introduction,m.address,m.company_num,m.product_num,m.is_del,m.gmt_created,m.gmt_modified,m.words,m.check_status \
      from market as m
      sql_attr_string  = pname
      sql_attr_string  = words
      sql_attr_uint    = company_num
      sql_attr_uint    = product_num
      sql_attr_uint    = is_del
      sql_attr_uint    = pid
      sql_attr_uint    = check_status
}
#index market
index market
{
      source           = market
      path             = /mnt/coreseek/var/data/market
      docinfo          = extern
      mlock            = 0
      morphology       = none
      min_word_len     = 1
      html_strip       = 0

      charset_dictpath = /usr/local/mmseg3/etc/
      charset_type = utf-8
      charset_table = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F
      ngram_len = 1
      ngram_chars = U+3000..U+2FA1F
}
source yuanliao
{
        type                            = mysql
        sql_host                        = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
        sql_user                        = ast
        sql_pass                        = astozz91jiubao
        sql_db                          = ast
        sql_port                        = 3306
        sql_query_pre                   = SET NAMES utf8
        sql_query_pre                   = SET SESSION query_cache_type=OFF
	##	sql_query_pre 		            = REPLACE INTO counter1 SELECT 14,UNIX_TIMESTAMP(gmt_modified) FROM yuanliao
        sql_query                       = SELECT yl.id,yl.company_id,yl.title,yl.title as ttitle,left(yl.category_yuanliao_code,8) as label1,left(yl.category_yuanliao_code,12) as label2,left(yl.category_yuanliao_code,16) as label3,yl.yuanliao_type_code,yl.yuanliao_type_code as type_code,yl.category_main_desc,yl.category_assist_desc,yl.source_type_code,yl.trade_mark,yl.process_level,yl.chara_level,yl.useful_level,yl.type,yl.color,yl.density,yl.hardness,yl.tensile,yl.bending,yl.quantity,yl.unit,yl.price,yl.price as pprice,yl.min_price,yl.max_price,yl.price_unit,yl.provide_status,yl.goods_type_code,yl.location,yl.trade_intro,yl.description,yl.send_time,yl.check_status,yl.is_del,yl.is_pause,yl.check_person,yl.post_time,yl.check_time,yl.expire_time,yl.refresh_time,yl.gmt_created,yl.gmt_modified,yl.unpass_reason,UNIX_TIMESTAMP(yl.refresh_time) as rrefresh_time,UNIX_TIMESTAMP(yl.expire_time) as expiretime,length(ylp.id) as havepic,left(yl.location,12) as province,c.membership_code as member_code,c.name,c.area_code FROM yuanliao as yl \
        left OUTER JOIN company as c ON yl.company_id=c.id \
        left OUTER JOIN yuanliao_pic as ylp ON yl.id=ylp.yuanliao_id and ylp.check_status=1 and ylp.is_del=0 \
        where c.is_block='0'
        sql_attr_uint       = is_del
        sql_attr_uint       = check_status
        sql_attr_uint       = is_pause
        sql_attr_uint       = rrefresh_time
        sql_attr_uint       = member_code
        sql_attr_uint       = havepic
        sql_attr_string     = gmt_modified
        sql_attr_string     = ttitle
        sql_attr_string     = type_code
        sql_attr_uint       = pprice
        sql_attr_uint       = min_price
        sql_attr_uint       = max_price
	sql_attr_uint       = company_id
}
index yuanliao
{
        source                  = yuanliao             #对应的source名称
        path                    = /mnt/coreseek/var/data/yuanliao
        docinfo                 = extern
        mlock                   = 0
        morphology              = none
        min_word_len            = 1
        html_strip                              = 0
        charset_dictpath = /usr/local/mmseg3/etc/       #BSD、Linux环境下设置，/符号结尾
        #charset_dictpath = etc/                                                #Windows环境下设置，/符号结尾
        charset_type            = zh_cn.utf-8
}
source delta_yuanliao:yuanliao
{
        sql_ranged_throttle     = 100
        sql_query_pre           = SET NAMES utf8
        sql_query               =  SELECT yl.id,yl.company_id,yl.title,yl.title as ttitle,left(yl.category_yuanliao_code,8) as label1,left(yl.category_yuanliao_code,12) as label2,left(yl.category_yuanliao_code,16) as label3,yl.yuanliao_type_code,yl.yuanliao_type_code as type_code,yl.category_main_desc,yl.category_assist_desc,yl.source_type_code,yl.trade_mark,yl.process_level,yl.chara_level,yl.useful_level,yl.type,yl.color,yl.density,yl.hardness,yl.tensile,yl.bending,yl.quantity,yl.unit,yl.price,yl.price as pprice,yl.min_price,yl.max_price,yl.price_unit,yl.provide_status,yl.goods_type_code,yl.location,yl.trade_intro,yl.description,yl.send_time,yl.check_status,yl.is_del,yl.is_pause,yl.check_person,yl.post_time,yl.check_time,yl.expire_time,yl.refresh_time,yl.gmt_created,yl.gmt_modified,yl.unpass_reason,UNIX_TIMESTAMP(yl.refresh_time) as rrefresh_time,UNIX_TIMESTAMP(yl.expire_time) as expiretime,length(ylp.id) as havepic,left(yl.location,12) as province,c.membership_code as member_code,c.name,c.area_code FROM yuanliao as yl \
        left OUTER JOIN company as c ON yl.company_id=c.id \
        left OUTER JOIN yuanliao_pic as ylp ON yl.id=ylp.yuanliao_id and ylp.check_status=1 and ylp.is_del=0 \
        where c.is_block='0' and yl.check_status='1' and yl.is_pause='0' and yl.is_del='0' and UNIX_TIMESTAMP(yl.gmt_modified)>( SELECT max_doc_id FROM counter WHERE id=14)
        ##sql_query_post 		= REPLACE INTO counter1 SELECT 14,UNIX_TIMESTAMP(gmt_modified) FROM yuanliao
		
	sql_attr_uint       = is_del
        sql_attr_uint       = check_status
        sql_attr_uint       = is_pause
        sql_attr_uint       = rrefresh_time
        sql_attr_uint       = member_code
        sql_attr_uint       = havepic
        sql_attr_string     = gmt_modified
        sql_attr_string     = ttitle
        sql_attr_string     = type_code
        sql_attr_uint       = pprice
        sql_attr_uint       = min_price
        sql_attr_uint       = max_price
        sql_attr_uint       = company_id
}
index delta_yuanliao
{
        source                  = delta_yuanliao            #对应的source名称
        path                    = /mnt/coreseek/var/data/delta_yuanliao
        docinfo                 = extern
        mlock                   = 0
        morphology              = none
        min_word_len            = 1
        html_strip                              = 0
        charset_dictpath = /usr/local/mmseg3/etc/       #BSD、Linux环境下设置，/符号结尾
        charset_type            = zh_cn.utf-8
}

# source goods
source goods
{
        type                    = mysql
        sql_host                = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
        sql_user                = ast
        sql_pass                = astozz91jiubao
        sql_db                  = feiliao91
        sql_port                = 3306
        sql_query_pre           = SET NAMES utf8
        sql_query               = SELECT a.id,a.id as pid,a.company_id,a.title,a.main_category,a.is_import,concat('level',a.level) as level,concat('color',a.color) as color,concat('form',a.form) as form,a.use_level,a.use_intro,a.process_level,a.process_intro, \
                                a.char_level,a.char_intro,a.good_attribute,a.unit,a.price,a.has_tax,a.quantity,a.number,a.provide_code,a.location,a.detail,a.expire_time, \
                                a.fare,a.is_del,a.is_sell,a.check_status,a.address_id,a.check_person,a.check_time,a.refresh_time,a.gmt_created,a.gmt_modified ,\
                                b1.label as category_label1,b2.label as category_label2,b3.label as category_label3,b4.label as category_label4 \
                                FROM goods a \
                                LEFT OUTER JOIN goods_category AS b1 ON LEFT(a.main_category, 4) = b1.code \
                                LEFT OUTER JOIN goods_category AS b2 ON LEFT(a.main_category, 8) = b2.code \
                                LEFT OUTER JOIN goods_category AS b3 ON LEFT(a.main_category, 12) = b3.code \
                                LEFT OUTER JOIN goods_category AS b4 ON LEFT(a.main_category, 16) = b4.code

        sql_attr_uint            = pid
	sql_attr_uint            = check_status
        sql_attr_uint            = is_del
        sql_attr_uint            = is_sell
        sql_query_info_pre       = SET NAMES utf8
}
# index goods
index goods
{
    source            = goods             #对应的source名称
    path              = /mnt/coreseek/var/data/goodsPreTreeDay #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...
    docinfo           = extern
    mlock             = 0
    morphology        = none
    min_word_len      = 1
    html_strip        = 0
    charset_dictpath  = /usr/local/mmseg3/etc/ #BSD、Linux环境下设置，/符号结尾
    charset_type      = zh_cn.utf-8
}

#source trust_buy
source trust_buy
{
      type             = mysql
      sql_host         = rdsuy4s1hdg04yt0px30.mysql.rds.aliyuncs.com
      sql_port         = 3306
      sql_user         = ast
      sql_pass         = astozz91jiubao
      sql_db           = ast
      sql_query_pre   = SET NAMES utf8
      sql_query        = SELECT id,company_id,buy_no,status,title,color,price,level,useful,is_del,is_pause \
      from trust_buy
      sql_attr_string  = title
      sql_attr_uint    = is_del
      sql_attr_uint    = is_pause
}
#index trust_buy
index trust_buy
{
      source           = trust_buy
      path             = /mnt/coreseek/var/data/trust_buy
      docinfo          = extern
      mlock            = 0
      morphology       = none
      min_word_len     = 1
      html_strip       = 0

      charset_dictpath = /usr/local/mmseg3/etc/
      charset_type = utf-8
      charset_table = 0..9, A..Z->a..z, _, a..z, U+410..U+42F->U+430..U+44F, U+430..U+44F
      ngram_len = 1
      ngram_chars = U+3000..U+2FA1F
}

#全局index定义
indexer
{
	mem_limit			= 800M
	max_iops = 40
}

#searchd服务定义
searchd
{
    listen              = 9315
	read_timeout		= 20
	max_children		= 0
	max_matches		    = 10000000
	seamless_rotate		= 1
	preopen_indexes		= 1
	unlink_old			= 1
	listen_backlog      = 20
	max_packet_size     = 32M
	max_filters = 1024
	read_buffer = 2M
	pid_file = /mnt/coreseek/var/log/index.pid
	log = /mnt/coreseek/var/log/index.log
}

