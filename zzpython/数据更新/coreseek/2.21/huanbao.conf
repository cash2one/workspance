#MySQL数据源配置，详情请查看：http://www.coreseek.cn/products-install/mysql/
#请先将var/test/documents.sql导入数据库，并配置好以下的MySQL用户密码数据库

#源定义
source huanbao_trade_supply
{
    type                    = mysql
    sql_host                = 192.168.2.10
    sql_user                = root
    sql_pass                = zj88friend
    sql_db                  = ep
    sql_port                = 3306
    sql_query_pre           = SET NAMES utf8
	sql_query               = SELECT ts.id,\
								ts.uid,\
								ts.title,\
								ts.title as ptitle,\
								ts.id as pid,\
								c1.name AS category_label1,\
								c2.name AS category_label2,\
								c3.name AS category_label3,\
								c4.name AS category_label4,\
								p1.name AS area_label1,\
								p2.name AS area_label2,\
								p3.name AS area_label3,\
								p4.name AS area_label4,\
								p5.name AS area_label5,\
								p6.name AS area_name,\
								p6.name as parea_name,\
								p7.name AS province_name,\
								p7.name as pprovince_name,\
								ts.cid,\
								ts.photo_cover,\
								ts.price_num,\
								ts.price_units,\
								ts.price_from,\
								ts.price_to,\
								ts.use_to,\
								ts.tags,\
								ts.used_product,\
								ts.details_query,\
								left(ts.details_query,100) as details,\
								ts.property_query,\
								UNIX_TIMESTAMP(ts.gmt_publish) as gmt_publish,\
								UNIX_TIMESTAMP(ts.gmt_refresh) as gmt_refresh,\
								ts.valid_days,\
								UNIX_TIMESTAMP(ts.gmt_expired) as gmt_expired,\
							    cp.name,\
								cp.name as pname,\
								cp.member_code,\
								m1.name as member_name,\
								m1.name as pmember_name \
						FROM trade_supply as ts \
						INNER JOIN comp_profile as cp ON ts.cid = cp.id \
						LEFT OUTER JOIN trade_category AS c1 ON LEFT(ts.category_code, 4) = c1.code \
						LEFT OUTER JOIN trade_category AS c2 ON LEFT(ts.category_code, 8) = c2.code \
						LEFT OUTER JOIN trade_category AS c3 ON LEFT(ts.category_code, 12) = c3.code \
						LEFT OUTER JOIN trade_category AS c4 ON LEFT(ts.category_code, 16) = c4.code \
						LEFT OUTER JOIN sys_area AS p1 ON LEFT(ts.area_code, 4) = p1.code \
						LEFT OUTER JOIN sys_area AS p2 ON LEFT(ts.area_code, 8) = p2.code \
						LEFT OUTER JOIN sys_area AS p3 ON LEFT(ts.area_code, 12) = p3.code \
						LEFT OUTER JOIN sys_area AS p4 ON LEFT(ts.area_code, 16) = p4.code \
						LEFT OUTER JOIN sys_area AS p5 ON LEFT(ts.area_code, 20) = p5.code \
						LEFT OUTER JOIN sys_area AS p6 ON ts.area_code = p6.code \
						LEFT OUTER JOIN sys_area AS p7 ON ts.province_code = p7.code \
						LEFT OUTER JOIN crm_member AS m1 ON cp.member_code = m1.code \
						where ts.check_status = 1 AND ts.pause_status = 0 AND ts.del_status = 0
                                                              #sql_query第一列id需为整数
                                                              #title、content作为字符串/文本字段，被全文索引
    sql_attr_uint            = pid
	sql_attr_uint       = gmt_refresh  #从SQL读取到的值必须为整数，作为时间属性
	sql_attr_uint            = uid
	sql_attr_uint            = cid
	sql_attr_uint            = price_num
	sql_attr_uint            = price_from
	sql_attr_uint            = price_to
	sql_attr_string          = title
	sql_attr_string          = name
	sql_attr_string          = member_name
	sql_attr_string          = area_name
	sql_attr_string          = province_name
	sql_attr_string          = details
	sql_attr_string          = photo_cover
	sql_attr_string          = price_units
	sql_attr_string          = use_to
	sql_attr_string          = used_product
	sql_query_info_pre       = SET NAMES utf8                                        #命令行查询时，设置正确的字符集
}

#index定义
index huanbao_trade_supply
{
    source            = huanbao_trade_supply             #对应的source名称
    path              = /usr/apps/coreseek/var/data/huanbao_trade_supply #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...
    docinfo           = extern
    mlock             = 0
    morphology        = none
    min_word_len      = 1
    html_strip        = 0

    #中文分词配置，详情请查看：http://www.coreseek.cn/products-install/coreseek_mmseg/
    charset_dictpath  = /usr/local/mmseg3/etc/ #BSD、Linux环境下设置，/符号结尾
    #charset_dictpath = /usr/apps/coreseek/etc/                             #Windows环境下设置，/符号结尾，最好给出绝对路径，例如：C:/usr/local/coreseek/etc/...
    charset_type      = zh_cn.utf-8
}

source huanbao_company
{
    type                    = mysql
    sql_host                = 192.168.2.10
    sql_user                = root
    sql_pass                = zj88friend
    sql_db                  = ep
    sql_port                = 3306
    sql_query_pre           = SET NAMES utf8
	sql_query               = select ts.id,\
								ts.id as pid, \
								ts.name,\
								ts.name as pname,\
								ts.details_query as details,\
								ts.details_query as pdetails,\
								ts.industry_code,\
								ts.business_code,\
								ts.main_buy,\
								ts.main_product_buy,\
								ts.main_supply,\
								ts.main_product_supply,\
								ts.address,\
								ts.address as paddress,\
								ts.province_code,\
								ts.area_code, \
								p1.name AS area_label1,\
								p2.name AS area_label2,\
								p3.name AS area_label3,\
								p4.name AS area_label4,\
								p5.name AS area_label5,\
								p6.name AS area_name,\
								p6.name as parea_name,\
								p7.name AS province_name,\
								p7.name as pprovince_name, \
								pa.types, \
								pa.name as indeustry_name \
								from comp_profile as ts \
								LEFT OUTER JOIN sys_area AS p1 ON LEFT(ts.area_code, 4) = p1.code \
								LEFT OUTER JOIN sys_area AS p2 ON LEFT(ts.area_code, 8) = p2.code \
								LEFT OUTER JOIN sys_area AS p3 ON LEFT(ts.area_code, 12) = p3.code \
								LEFT OUTER JOIN sys_area AS p4 ON LEFT(ts.area_code, 16) = p4.code \
								LEFT OUTER JOIN sys_area AS p5 ON LEFT(ts.area_code, 20) = p5.code \
								LEFT OUTER JOIN sys_area AS p6 ON ts.area_code = p6.code \
								LEFT OUTER JOIN sys_area AS p7 ON ts.province_code = p7.code \
								LEFT OUTER JOIN param AS pa ON ts.industry_code = pa.value
    sql_attr_uint            = pid
	sql_attr_string          = details
	sql_attr_string          = name
	sql_attr_string          = address
	sql_attr_string          = main_buy
	sql_attr_string          = main_product_buy
	sql_attr_string          = main_supply
	sql_attr_string          = main_product_supply
	sql_attr_string          = area_name
	sql_attr_string          = province_name
	sql_attr_string          = indeustry_name
	sql_query_info_pre       = SET NAMES utf8                                        #命令行查询时，设置正确的字符集
}

#index定义
index huanbao_company
{
    source            = huanbao_company             #对应的source名称
    path              = /usr/apps/coreseek/var/data/huanbao_company #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...
    docinfo           = extern
    mlock             = 0
    morphology        = none
    min_word_len      = 1
    html_strip        = 0

    #中文分词配置，详情请查看：http://www.coreseek.cn/products-install/coreseek_mmseg/
    charset_dictpath  = /usr/local/mmseg3/etc/ #BSD、Linux环境下设置，/符号结尾
    #charset_dictpath = /usr/apps/coreseek/etc/                             #Windows环境下设置，/符号结尾，最好给出绝对路径，例如：C:/usr/local/coreseek/etc/...
    charset_type      = zh_cn.utf-8
}

#全局index定义
indexer
{
    mem_limit           = 128M
}

#searchd服务定义
searchd
{
    listen              = 9312
    read_timeout        = 5
    max_children        = 30
    max_matches         = 100000
    seamless_rotate     = 0
    preopen_indexes     = 0
    unlink_old          = 1
    pid_file            = /usr/apps/coreseek/var/log/searchd_huanbao_trade_supply.pid  #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...
    log                 = /usr/apps/coreseek/var/log/searchd_huanbao_trade_supply.log        #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...
    query_log           = /usr/apps/coreseek/var/log/query_huanbao_trade_supply.log #请修改为实际使用的绝对路径，例如：/usr/local/coreseek/var/...
    binlog_path         =                                #关闭binlog日志
}
