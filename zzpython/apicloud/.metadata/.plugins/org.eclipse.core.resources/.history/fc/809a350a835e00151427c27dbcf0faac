<!DOCTYPE html>
<html lang='zh-CN'>
    <head>
        <meta charset='utf-8'>
        <meta name='viewport' content='maximum-scale=1.0,minimum-scale=1.0,user-scalable=no,width=device-width,initial-scale=1.0'/>
        <title>日历演示</title>
        <link rel='stylesheet' type='text/css' href='../bootstrap/css/bootstrap.min.css' />
		<link rel='stylesheet' href='../css/github.css'>
		<style type='text/css'>
		  .diy-btn-group-test {margin : 10px 0px 0px 0px;}
		</style>
		
    </head>
    <body>
		<!--
        <div id="wrap">
            <div id="main">
                <h3>录音</h3>
                路径：<input id="path" type="text" value="fs://aaa.amr" />
                <div>
                <button tapmode="active" onclick="objSRecord()" class="btn btn-default btn-rec1 btntmp" id="sRecord">开始录音</button>
                <button tapmode="active" onclick="objERecord()" class="btn btn-default btn-stop btntmp" id="eRecord">停止录音</button>
                </div>
                <br>
                <textarea id="showRec" style="height:4em;"></textarea>
                <h3>播放音频</h3>
                路径：<input id="path1" type="text" value="fs://aaa.amr" />
                <div>
                <button tapmode="active" onclick="objStart()" class="btn btn-default btn-play1 btntmp" id="start">播放</button>
                <button tapmode="active" onclick="objStop()" class="btn btn-default btn-stop btntmp" id="stop">停止</button>
                </div>
                <br />
                <button tapmode="active" onclick="btnGet()" class="btn btn-default">打开本地视频</button>
                <label>播放本地未完成</label>
                
                <h3>网络视频</h3>
                <input id="url" type="text" value="http://117.78.7.24:3000/case_res/mov.mp4" />
                <button tapmode="active" onclick="btnPlay()" class="btn btn-default">打开网络视频</button>           
            </div>
            
        </div>
			-->
    </body>
	<script src="../script/jquery-1.11.1.min.js"></script>
	<script src='../script/demo.js'></script>
	<script src='../script/highlight.pack.js'></script>
	<script>
	var demo = Demo.createNew();
	demo.show(function(){
				$('pre code').each(function(i, block) {
				    hljs.highlightBlock(block);
				  });});
	</script>
	
    <script type='text/javascript' src='../script/api.js'></script>
    <script type='text/javascript'>
    var rPath = $api.byId('path');
    var pPath = $api.byId('path1');
    var rImg = $api.byId('sRecord');
    var sImg = $api.byId('start');
    var otext = $api.byId('showRec');
    function objSRecord(){
        if ($api.hasCls(rImg,'btn-rec1')) {
            $api.removeCls(rImg,'btn-rec1');
            $api.addCls(rImg,'btn-rec2');
        };
        var path = $api.trimAll(rPath.value);
        var json = {}
        if (path!=='') {
            var json = {
                path: rPath.value
            }
        }
        api.startRecord(json);
    };
    function objERecord(){
        if ($api.hasCls(rImg,'btn-rec2')) {
            $api.removeCls(rImg,'btn-rec2');
            $api.addCls(rImg,'btn-rec1');
            
        };
        api.stopRecord(function(ret,err){
            if (ret) {
                $api.val(otext,'文件路径--'+ret.path+';录音时长:'+ret.duration+'s');
            };
        });
        
    };
    function objStart(){
        if ($api.hasCls(sImg,'btn-play1')) {
            $api.removeCls(sImg,'btn-play1');
            $api.addCls(sImg,'btn-play2');
        }; 
        api.startPlay({
            path: pPath.value
        },function(){
            objStop();
        });
    };
    function objStop(){
        if ($api.hasCls(sImg,'btn-play2')) {
            $api.removeCls(sImg,'btn-play2');
            $api.addCls(sImg,'btn-play1');              
        }; 
        api.stopPlay();
    };
    function btnGet(){
    	api.getPicture(
    		{
    			sourceType: 'library',
    			mediaValue: 'video'
    		},function(ret,err){
    			if(ret){
    				api.openVideo(
    					{
    						url: ret.data
    					}
    					
    				);
    			}else{
    				api.alert(
    					{
    						msg: ('错误码:'+err.code+'--错误描述:'+err.msg)
    					}
    				);
    			}
    		}
    	)
    };
    function btnPlay(){
        var url = $api.byId('url').value;
    	api.openVideo(
    		{
    			url: url
    		}
    	);
    };
    </script>
</html>
