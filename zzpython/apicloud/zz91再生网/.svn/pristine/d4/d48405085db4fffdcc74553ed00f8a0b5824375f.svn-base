<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
		<title>首页-导航</title>
		<link rel="stylesheet" type="text/css" href="../css/api.css" />
		<link rel="stylesheet" type="text/css" href="../css/common.css" />
		<link rel="stylesheet" type="text/css" href="../css/index.css" />
	</head>
	<body>
		<div id="wrap">
			<div id="main"></div>
			<div id="footer">
				<ul>
					<li tapmode="active" class="active" onclick="randomSwitchBtn(this,'cloud',0)">
						<a class="bottom_btn cloud"><i></i><span>首页</span></a>
					</li>
					<li tapmode="active" onclick="randomSwitchBtn(this,'cloud',1)">
						<a class="bottom_btn client "><i></i><span>帮你找</span></a>
					</li>
					<li tapmode="active" onclick="randomSwitchBtn(this,'cloud',2)">
						<a class="bottom_btn dev "><i></i><span>消息</span></a>
					</li>
					<li tapmode="active" onclick="randomSwitchBtn(this,'cloud',3)">
						<a class="bottom_btn doc "><i></i><span>管家</span></a>
					</li>
				</ul>
			</div>
		</div>
	</body>
	<script type="text/javascript" src="../script/api.js"></script>
	<script type="text/javascript" src="../script/zepto.min.js"></script>
	<script type="text/javascript" src="../script/common.js"></script>
	<script type="text/javascript">
		apiready = function() {
			var systemType = api.systemType;
			if (systemType != "ios") {
				$("header").css("padding-top", "0px")
			}
			openFrameGroup();
			$(".category").on("click", function() {
				var pageParam = {
					wintitle : "产品类目",
					type : "product-category",
					bounces : false
				};
				openWin("product-category", "../trade/product-category.html", pageParam);
			})
			//消息中心
			$(".my-info").on("click", function() {
				var pageParam = {
					wintitle : "消息中心",
					type : "heart-info"
				};
				if (UserInfo.has_login()) {
					openWin("heart-info", "../comm/heart-info.html", pageParam);
				} else {
					pageParam.nextUrl = "widget://html/comm/heart-info.html";
					pageParam.winName = "heart-info";
					openWin("frm-login", "../myrc/frm-login.html", pageParam);
				}
			})
			//发布页面
			$(".my-gout").on("click", function() {
				var pageParam = {
					wintitle : "发布信息",
					type : "issue-info",
					module : "发布"
				};
				openWin("issue-info", "../myrc/issue-info.html", pageParam);
			})
			//点击搜索框
			$(".select-ipt").on("click", function() {
				openSearch();
			})
		}
		//打开openFrameGroup
		function openFrameGroup() {
			//var $header = $api.dom('header');
			//$api.fixIos7Bar($header);
			var $body = $api.dom('body');
			var $footer = $api.byId('footer');
			//var header_h = $api.offset($header).h;
			var header_h = 0;
			var body_h = $api.offset($body).h;
			var footer_h = $api.offset($footer).h;
			var rect_h = body_h - header_h - footer_h;
			var pageParam = {
				wintitle : "帮你找",
				type : "help-list",
				nav_list : [{
					"typename" : "全部",
					"id" : 0
				}, {
					"typename" : "找供应",
					"id" : 1
				}, {
					"typename" : "找求购",
					"id" : 2
				}],
				module : "发布需求",
				guandu : {'height':header_h,'bottom':footer_h},
				frame_url : ["../trade/help-list.html"], //,"../trade/help-list.html","../trade/help-list-sj.html"
				topnumber : 3 //滚动Nav栏数码
			};
			api.openFrameGroup({
				name : 'indexgroup',
				scrollEnabled : false,
				rect : {
					x : 0,
					y : header_h,
					w : 'auto',
					h : rect_h
				},
				index : 0,
				frames : [{
					name : 'index-frame',
					bounces : true,
					url : '../html/index-frame.html'
				}, {
					name : 'help',
					bounces : true,
					pageParam : pageParam,
					url : '../html/trade/help-main.html'
				}, {
					name : 'quote',
					bounces : true,
					url : '../html/comm/heart-info.html'
				}, {
					name : 'my-home',
					url : '../html/myrc/my-home.html'
				}]
			}, function(ret, err) {
			});
		}

		// 随意切换按钮
		function randomSwitchBtn(obj, name, index) {
			if (index == 1) {
				api.execScript({
					frameName : 'help',
					script : "getNavlist()"
				});
				//return;
			}else{
				api.execScript({
					frameName : 'help',
					script : "closehelp()"
				});
			}
//			var $header = $api.dom('header');
//			var $titleBar = $api.domAll($header, '.topbar');
//			for (var i = 0; i < $titleBar.length; i++) {
//				$api.removeCls($titleBar[i], 'activebar');
//			}
			$api.addCls($api.byId(name), 'activebar');
			var $footer = $api.byId('footer');
			var $footerBar = $api.domAll($footer, 'li');
			for (var j = 0; j < $footerBar.length; j++) {
				$api.removeCls($footerBar[j], 'active');
			}
			$api.addCls(obj, 'active');
			api.setFrameGroupIndex({
				name : 'indexgroup',
				index : index
			});
		}

		//生意管家调用方法
		function myHome() {
			$("#footer").find("li").eq(3).on('click', function() {
				randomSwitchBtn(this, 'cloud', 3)
			});
			$("#footer").find("li").eq(3).click();
		}
	</script>
</html>