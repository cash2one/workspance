<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>首页</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../css/common.css"/>
    <link rel="stylesheet" type="text/css" href="../css/index-frame.css"/>
</head>
<body>
  <div class="index-nav-div">
    <ul class="index-nav clear">
      <li tapmode="index-nav-li" class="jy-heart"><i class="nav_image1"></i>交易中心</li>
      <li tapmode="index-nav-li" class="offer-list"><i class="nav_image2"></i>行情报价</li>
      <li tapmode="index-nav-li" class="infomation-heart"><i class="nav_image3"></i>资讯中心</li>
      <li tapmode="index-nav-li" class="firm-page"><i class="nav_image4"></i>公司黄页</li>
      <li tapmode="index-nav-li" class="community"><i class="nav_image5"></i>互助社区</li>
      <li tapmode="index-nav-li" class="my-home"><i class="nav_image6"></i>生意管家</li>
      <li tapmode="index-nav-li" class="my-block"><i class="nav_image7"></i>再生钱包</li>
      <li tapmode="index-nav-li" class="vender"><i class="nav_image8"></i>厂家直购</li>
    </ul>
  </div>
  <div class="hot-products">
    <div class="hot-title clear border-bottom">
      <h4>热门产品</h4>
      <span class="more-hf">更多<i class="more"></i></span>
    </div>
    <!-- <div class="hot-list-buy border-bottom">
      <ul class="list-buy-ul clear">
        <li>
          <div class="buy-name">长期求购PP</div>
          <div class="buy-pic"></div>
        </li>
        <li>
          <div class="buy-name">长期求购PP</div>
          <div class="buy-pic"></div>
        </li>
      </ul>
    </div> -->
    <div class="hot-list-sell">
      <ul class="list-buy-ell clear list-buy-ell2 j_hot">
        <li tapmode="index-nav-li">
          <div class="buy-name j_buyname"></div>
          <div class="buy-pic j_buypic"><img width="100%" height="100%"></div>
        </li>
        <li tapmode="index-nav-li">
          <div class="buy-name j_buyname"></div>
          <div class="buy-pic j_buypic"><img width="100%" height="100%"></div>
        </li>
        <li tapmode="index-nav-li">
          <div class="buy-name j_buyname"></div>
          <div class="buy-pic j_buypic"><img width="100%" height="100%"></div>
        </li>
        <li tapmode="index-nav-li">
          <div class="buy-name j_buyname"></div>
          <div class="buy-pic j_buypic"><img width="100%" height="100%"></div>
        </li>
        <li tapmode="index-nav-li">
          <div class="buy-name j_buyname"></div>
          <div class="buy-pic j_buypic"><img width="100%" height="100%"></div>
        </li>
      </ul>
    </div>
  </div>
  <div class="day-buy">
    <div class="hot-title clear border-bottom">
      <h4>每日抢购</h4>
      <span class="stratime"><i class="timepic"></i><span class="j_time"></span></span>
    </div>
    <div class="day-buy-list clear border-bottom" tapmode="index-nav-li">
      <div class="day-buy-info">
        <div class="zzmoery"></div>
        <div class="qg-moery"><span class="morey-num"></span></div>
      </div>
      <div class="day-buy-pic">
        <img width="100%" height="100%">
      </div>
    </div>
  </div>
  <div class="good-groom">
    <div class="hot-title clear border-bottom">
      <h4>优质推荐</h4>
      <span class="more-hf">更多<i class="more"></i></span>
    </div>
    <div class="impt-info border-bottom">
      <div class="impt-info-mo impt-info-first" tapmode="index-nav-li">
        <div class="buy-name buy-name-secd"></div>
        <span class="heft"></span>
        <div class="buy-pic buy-pic-first j_tjpic"><img width="100%" height="100%"></div>
      </div>
      <div class="impt-info-mo impt-info-sed">
        <div class="impt-sed-content border-bottom" tapmode="index-nav-li">
          <div class="buy-name buy-name-secd"></div>
          <span class="heft"></span>
          <div class="buy-impt-pic j_tjpic"><img width="100%" height="100%"></div>
        </div>
        <div class="impt-sed-content" tapmode="index-nav-li">
          <div class="buy-name buy-name-secd"></div>
          <span class="heft"></span>
          <div class="buy-impt-pic j_tjpic"><img width="100%" height="100%"></div>
        </div>
      </div>
    </div>
    <div class="hot-list-sell">
      <ul class="list-buy-ell clear">
        <li tapmode="index-nav-li">
          <div class="buy-name buy-name-secd"></div>
          <span class="heft"></span>
          <div class="buy-pic j_tjpic"><img width="100%" height="100%"></div>
        </li>
        <li tapmode="index-nav-li">
          <div class="buy-name buy-name-secd"></div>
          <span class="heft"></span>
          <div class="buy-pic j_tjpic"><img width="100%" height="100%"></div>
        </li>
        <li tapmode="index-nav-li">
          <div class="buy-name buy-name-secd"></div>
          <span class="heft"></span>
          <div class="buy-pic j_tjpic"><img width="100%" height="100%"></div>
        </li>
      </ul>
    </div>
  </div>
  <div class="market">
    <div class="market-titel clear">
      <h4>行情报价</h4>
      <span class="stratime dypic-span"><i class="timepic dypic"></i>订阅</span>
    </div>
    <ul class="market-list">
    <script id="info-list" type="text/html">
      <li class="change-bgcolor" id="{{ d.id }}">{{ d.title }}</li>
    </script>
      <li tapmode="index-nav-li" class="j_more">查看更多<span class="see-alost"></span></li>
    </ul>
  </div>
  <ul class="other-mo">
    <li>
      <span class="other-mo-tlt">互助热帖</span>
      <span class="other-mo-jjie j_huzhu" tapmode="index-nav-li"></span>
    </li>
    <li>
      <span class="other-mo-tlt">最新资讯</span>
      <span class="other-mo-jjie j_zuixin" tapmode="index-nav-li"></span>
    </li>
  </ul>
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/zepto.min.js"></script>
<script type="text/javascript" src="../script/common.js"></script>
<script type="text/javascript" src="../script/laytpl.js"></script>
<script>
  apiready = function () {
      //行情报价更多
      $(".j_more").on("click",function(){
        var pageParam = {
          type:"price",
          bounces:false
        };
        openWin("price","../price/price.html",pageParam);
      })
      //更多
      $(".more-hf").on("click",function(){
        var pageParam = {
          wintitle:"产品类目",
          type:"product-category",
          bounces:false
        };
        openWin("product-category","../trade/product-category.html",pageParam);
      })
      //优质推荐
      $(".buy-name-secd").parent().on("click",function(){
        var id = $(this).attr("id");
        var pageParam = {
            wintitle:"供求详情",
            type:"infomation-heart",
            id:id,
            nav_list:[{"typename": "供求详情", "id": 1}, {"typename": "公司简介", "id": 2}], //头部划动标题
            frame_url:["../trade/firm-detail.html","../trade/firm.html"], //打开frame组的页面集合
            topnumber:2,
            bounces:false
          };
        openWin("infomation-heart","infomation-heart.html",pageParam);
      })
      //互动社区
      $(".community").on("click",function(){
        var pageParam = {
          type:"community",
          module:"发布",      //头部右边文字
          nav_list:[{"typename": "问答", "id": 1}, {"typename": "社区", "id": 2}, {"typename": "学院", "id": 3}, {"typename": "热门", "id": 4}],
          frame_url:["../huzhu/hudong-list.html"],
          topnumber:4    //滚动Nav栏数码
        };
        openWin("community","widget://html/comm/infomation-heart.html",pageParam);
      })
      //再生钱包
      $(".my-block").on("click",function(){
        var pageParam = {
          wintitle:"再生钱包",
          type:"burse"
        };
        openWin("burse","../myrc/burse.html",pageParam);
      });
      //交易中心
       $(".jy-heart").on("click",function(){
        var pageParam = {
          wintitle:"产品类目",
          type:"product-category",
          bounces:false
        };
        openWin("product-category","../trade/product-category.html",pageParam);
      })
      //直购
      $(".vender").on("click",function(){
        var pageParam = {
          wintitle:"厂家直购",
          type:"vender"
        };
        openWin("vender","../zhigou/vender.html",pageParam);
      })
      //生意管家
      $(".my-home").on("click",function(){
        api.execScript({
          script: "myHome()"
        });
      })
      //行情报价
      $(".offer-list").on("click",function(){
        var pageParam = {
          type:"price",
          bounces:false
        };
        openWin("price","../price/price.html",pageParam);
      })
      //公司黄页
      $(".firm-page").on("click",function(){
        var pageParam = {
          wintitle:"公司黄页",
          type:"offer-list"
        };
        openWin("firm-page","../company/firm-page.html",pageParam);
      })
      //订阅
      $(".dypic-span").on("click",function(){
        var pageParam = {
          wintitle:"订阅报价",
          type:"take-price"
        };
        openWin("take-price","../price/take-price.html",pageParam);
      })
      //获取首页数据
      ajaxInfo();
      //加载资讯中心列表菜单
      zixunList();
  }
  function ajaxInfo(){
    api.showProgress({title:'加载中',modal:false});
    api.ajax({
      url : hosturl + '/index.html?datatype=json',
      method : 'get',
      timeout : 30,
      dataType : 'json',
      returnAll : false
    }, function(ret, err) {
      if (ret) {
        //每日抢购
        if(ret.ad2_1){
          $(".zzmoery").text(ret.ad2_1.goodsName);
          $(".qg-moery").text(ret.ad2_1.goodsname_fu);
          $(".day-buy-pic img").attr("src",ret.ad2_1.pic);
          show_time();
          //每日抢购
          $(".day-buy-list").on("click",function(){
            var pageParam = {
              wintitle:"庆国庆再生钱包活动",
              type:"sold-bug"
            };
            openWin("sold-bug","../qianbao/sold-bug.html",pageParam);
          })
        }else{
          $(".day-buy").hide();
        }
        //热门产品
        $(".j_buyname").eq(0).text(ret.ad3.ad3_1.goodsName);
        $(".j_buyname").eq(0).parent().attr("tourl",ret.ad3.ad3_1.tourl)
        $(".j_buyname").eq(1).text(ret.ad3.ad3_2.goodsName);
        $(".j_buyname").eq(1).parent().attr("tourl",ret.ad3.ad3_2.tourl)
        $(".j_buyname").eq(2).text(ret.ad3.ad3_3.goodsName);
        $(".j_buyname").eq(2).parent().attr("tourl",ret.ad3.ad3_3.tourl)
        $(".j_buyname").eq(3).text(ret.ad3.ad3_4.goodsName);
        $(".j_buyname").eq(3).parent().attr("tourl",ret.ad3.ad3_4.tourl)
        $(".j_buyname").eq(4).text(ret.ad3.ad3_5.goodsName);
        $(".j_buyname").eq(4).parent().attr("tourl",ret.ad3.ad3_5.tourl)
        $(".j_buypic").eq(0).find("img").attr("src",ret.ad3.ad3_1.pic);
        $(".j_buypic").eq(1).find("img").attr("src",ret.ad3.ad3_2.pic);
        $(".j_buypic").eq(2).find("img").attr("src",ret.ad3.ad3_3.pic);
        $(".j_buypic").eq(3).find("img").attr("src",ret.ad3.ad3_4.pic);
        $(".j_buypic").eq(4).find("img").attr("src",ret.ad3.ad3_5.pic);
        //优质推荐
        $(".buy-name-secd").eq(0).text(ret.ad1_1.goodsName);
        $(".buy-name-secd").eq(1).text(ret.ad1_2.goodsName);
        $(".buy-name-secd").eq(2).text(ret.ad1_3.goodsName);
        $(".buy-name-secd").eq(3).text(ret.ad1_4.goodsName);
        $(".buy-name-secd").eq(4).text(ret.ad1_5.goodsName);
        $(".buy-name-secd").eq(5).text(ret.ad1_6.goodsName);
        $(".heft").eq(0).text(ret.ad1_1.goodsname_fu);
        $(".heft").eq(1).text(ret.ad1_2.goodsname_fu);
        $(".heft").eq(2).text(ret.ad1_3.goodsname_fu);
        $(".heft").eq(3).text(ret.ad1_4.goodsname_fu);
        $(".heft").eq(4).text(ret.ad1_5.goodsname_fu);
        $(".heft").eq(5).text(ret.ad1_6.goodsname_fu);
        $(".j_tjpic").eq(0).find("img").attr("src",ret.ad1_1.pic);
        $(".j_tjpic").eq(1).find("img").attr("src",ret.ad1_2.pic);
        $(".j_tjpic").eq(2).find("img").attr("src",ret.ad1_3.pic);
        $(".j_tjpic").eq(3).find("img").attr("src",ret.ad1_4.pic);
        $(".j_tjpic").eq(4).find("img").attr("src",ret.ad1_5.pic);
        $(".j_tjpic").eq(5).find("img").attr("src",ret.ad1_6.pic);
        $(".buy-name-secd").eq(0).parent().attr("id",ret.ad1_1.id.substr(1));
        $(".buy-name-secd").eq(1).parent().attr("id",ret.ad1_2.id.substr(1));
        $(".buy-name-secd").eq(2).parent().attr("id",ret.ad1_3.id.substr(1));
        $(".buy-name-secd").eq(3).parent().attr("id",ret.ad1_4.id.substr(1));
        $(".buy-name-secd").eq(4).parent().attr("id",ret.ad1_5.id.substr(1));
        $(".buy-name-secd").eq(5).parent().attr("id",ret.ad1_6.id.substr(1));
        //行情报价
        var pageHtml = "";
        $.each(ret.pricelist.list, function(index, item) {
          var getTpl = $api.html($api.byId("info-list"));
          laytpl(getTpl).render(item, function(html) {
            pageHtml = pageHtml + html;
          });
        })
        $(".market-list").prepend(pageHtml);
        //互助热贴
        $(".j_huzhu").text(ret.onehuzhulist.title).attr("id",ret.onehuzhulist.id);
        //最新资讯
        $(".j_zuixin").text(ret.onenewslist.title).attr("id",ret.onenewslist.id);
        api.hideProgress();
        //互助详情
        $(".other-mo").on("click",".j_huzhu",function(){
          var infoid = $(this).attr("id")
          var pageParam = {
                wintitle:"互助详情",
                type:"cunity-detail",
                bounces:false,
                infoid:infoid
              };
          openWin("cunity-detail","../huzhu/cunity-detail.html",pageParam);
        })
        //资讯详情
        $(".other-mo").on("click",".j_zuixin",function(){
          var infoid = $(this).attr("id")
          var pageParam = {
                wintitle:"资讯详情",
                type:"detail",
                bounces:false,
                infoid:infoid
              };
          openWin("detail","../news/detail.html",pageParam);
        })
        //行情报价详情
        $(".market-list").on("click","li",function(){
          var id = $(this).attr("id");
          if(!id){
            return;
          }
          var pageParam = {
              wintitle:"报价详情",
              type:"price-detail",
              id:id
            };
          openWin("price-detail"+id,"../price/price-detail.html",pageParam);
        })
        //热门产品
        $(".j_hot").on("click","li",function(){
          var tourl = $(this).attr("tourl");
          var substr = tourl.match(/keywords=(\S*)/);
          var pageParam = {
            type : "trade-list",
            label_hex:substr[1]
          };
          openWin("trade-list", "../trade/trade-list.html", pageParam);
        })
      } else {
      };
    });
  }
//没人抢购的倒计时
function show_time(){ 
  var time_start = new Date().getTime(); //设定当前时间
  var time_end =  new Date("2015/10/11 00:00:00").getTime(); //设定目标时间
  // 计算时间差 
  var time_distance = time_end - time_start; 
  // 天
  var int_day = Math.floor(time_distance/86400000) 
  time_distance -= int_day * 86400000; 
  // 时
  var int_hour = Math.floor(time_distance/3600000) 
  time_distance -= int_hour * 3600000; 
  // 分
  var int_minute = Math.floor(time_distance/60000) 
  time_distance -= int_minute * 60000; 
  // 秒 
  var int_second = Math.floor(time_distance/1000) 
  // 时分秒为单数时、前面加零 
  if(int_day < 10){ 
    int_day = "0" + int_day; 
  } 
  if(int_hour < 10){ 
    int_hour = "0" + int_hour; 
  } 
  if(int_minute < 10){ 
    int_minute = "0" + int_minute; 
  } 
  if(int_second < 10){
    int_second = "0" + int_second; 
  } 
  var lastTime = int_day + "天" + int_hour + "小时" + int_minute + "分" + int_second +"秒";
  $(".j_time").html(lastTime); 
  // 设置定时器
  setTimeout("show_time()",1000); 
}
//加载资讯中心列表菜单
function zixunList(){
  api.ajax({
      url : hosturl + '/news/columnlist.html?datatype=json',
      method : 'get',
      timeout : 30,
      dataType : 'json',
      returnAll : false
    }, function(ret, err) {
      if (ret) {
        //资讯中心页面
        $(".infomation-heart").on("click",function(){
          var pageParam = {
            wintitle:"资讯中心",
            type:"infomation-heart",
            nav_list:ret,
            frame_url:["../news/infolist.html"],
            topnumber:4   //滚动Nav栏数码
          };
          openWin("infomation-heart","widget://html/comm/infomation-heart.html",pageParam);
        })
      } else {
      };
    });
}
</script>
</html>