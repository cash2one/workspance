SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL';

ALTER TABLE `asto_ec_web`.`tb_trade` ADD COLUMN `tid` VARCHAR(45) NULL DEFAULT '' COMMENT '交易编号 (父订单的交易编号)'  AFTER `id` , ADD COLUMN `num` INT(11) NULL DEFAULT 0 COMMENT '商品购买数量。取值范围：大于零的整数,对于一个trade对应多个order的时候（一笔主订单，对应多笔子订单），num=0，num是一个跟商品关联的属性，一笔订单对应多比子订单的时候，主订单上的num无意义。'  AFTER `tid` , ADD COLUMN `num_iid` INT(11) NULL DEFAULT 0 COMMENT '商品数字编号'  AFTER `num` , ADD COLUMN `status` VARCHAR(45) NULL DEFAULT NULL COMMENT '交易状态。可选值: * TRADE_NO_CREATE_PAY(没有创建支付宝交易) * WAIT_BUYER_PAY(等待买家付款) * SELLER_CONSIGNED_PART(卖家部分发货) * WAIT_SELLER_SEND_GOODS(等待卖家发货,即:买家已付款) * WAIT_BUYER_CONFIRM_GOODS(等待买家确认收货,即:卖家已发货) * TRADE_BUYER_SIGNED(买家已签收,货到付款专用) * TRADE_FINISHED(交易成功) * TRADE_CLOSED(付款以后用户退款成功，交易自动关闭) * TRADE_CLOSED_BY_TAOBAO(付款以前，卖家或买家主动关闭交易)'  AFTER `num_iid` , ADD COLUMN `title` VARCHAR(254) NULL DEFAULT '' COMMENT '交易标题，以店铺名作为此标题的值。注:taobao.trades.get接口返回的Trade中的title是商品名称'  AFTER `status` , ADD COLUMN `type` VARCHAR(45) NULL DEFAULT '' COMMENT '交易类型列表，同时查询多种交易类型可用逗号分隔。默认同时查询guarantee_trade, auto_delivery, ec, cod的4种交易类型的数据 可选值 fixed(一口价) auction(拍卖) guarantee_trade(一口价、拍卖) auto_delivery(自动发货) independent_simple_trade(旺店入门版交易) independent_shop_trade(旺店标准版交易) ec(直冲) cod(货到付款) fenxiao(分销) game_equipment(游戏装备) shopex_trade(ShopEX交易) netcn_trade(万网交易) external_trade(统一外部交易) step (万人团) nopaid(无付款订单)'  AFTER `title` , ADD COLUMN `price` VARCHAR(45) NULL DEFAULT '' COMMENT '商品价格。精确到2位小数；单位：元。如：200.07，表示：200元7分'  AFTER `type` , ADD COLUMN `seller_cod_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家货到付款服务费。精确到2位小数;单位:元。如:12.07，表示:12元7分。卖家不承担服务费的订单：未发货的订单获取服务费为0，发货后就能获取到正确值。'  AFTER `price` , ADD COLUMN `discount_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '建议使用trade.promotion_details查询系统优惠 系统优惠金额（如打折，VIP，满就送等），精确到2位小数，单位：元。如：200.07，表示：200元7分'  AFTER `seller_cod_fee` , ADD COLUMN `has_post_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '是否包含邮费。与available_confirm_fee同时使用。可选值:true(包含),false(不包含)'  AFTER `discount_fee` , ADD COLUMN `total_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '商品金额（商品价格乘以数量的总金额）。精确到2位小数;单位:元。如:200.07，表示:200元7分'  AFTER `has_post_fee` , ADD COLUMN `created` DATETIME NULL DEFAULT NULL COMMENT '交易创建时间。格式:yyyy-MM-dd HH:mm:ss'  AFTER `total_fee` , ADD COLUMN `pay_time` DATETIME NULL DEFAULT NULL COMMENT '付款时间。格式:yyyy-MM-dd HH:mm:ss。订单的付款时间即为物流订单的创建时间。'  AFTER `created` , ADD COLUMN `modified` DATETIME NULL DEFAULT NULL COMMENT '交易修改时间(用户对订单的任何修改都会更新此字段)。格式:yyyy-MM-dd HH:mm:ss'  AFTER `pay_time` , ADD COLUMN `end_time` DATETIME NULL DEFAULT NULL COMMENT '交易结束时间。交易成功时间(更新交易状态为成功的同时更新)/确认收货时间或者交易关闭时间 。格式:yyyy-MM-dd HH:mm:ss'  AFTER `modified` , ADD COLUMN `buyer_message` VARCHAR(254) NULL DEFAULT '' COMMENT '买家留言'  AFTER `end_time` , ADD COLUMN `alipay_id` VARCHAR(45) NULL DEFAULT '' COMMENT '买家的支付宝id号，在UIC中有记录，买家支付宝的唯一标示，不因为买家更换Email账号而改变。'  AFTER `buyer_message` , ADD COLUMN `alipay_no` VARCHAR(45) NULL DEFAULT '' COMMENT '支付宝交易号，如：2009112081173831'  AFTER `alipay_id` , ADD COLUMN `alipay_url` VARCHAR(254) NULL DEFAULT '' COMMENT '创建交易接口成功后，返回的支付url'  AFTER `alipay_no` , ADD COLUMN `buyer_memo` VARCHAR(45) NULL DEFAULT '' COMMENT '买家备注（与淘宝网上订单的买家备注对应，只有买家才能查看该字段）'  AFTER `alipay_url` , ADD COLUMN `seller_memo` VARCHAR(254) NULL DEFAULT '' COMMENT '卖家备注（与淘宝网上订单的卖家备注对应，只有卖家才能查看该字段）'  AFTER `buyer_memo` , ADD COLUMN `buyer_nick` VARCHAR(45) NULL DEFAULT '' COMMENT '买家昵称'  AFTER `seller_memo` , ADD COLUMN `buyer_area` VARCHAR(45) NULL DEFAULT '' COMMENT '买家下单的地区'  AFTER `buyer_nick` , ADD COLUMN `buyer_email` VARCHAR(45) NULL DEFAULT '' COMMENT '买家邮件地址'  AFTER `buyer_area` , ADD COLUMN `area_id` VARCHAR(45) NULL DEFAULT '' COMMENT '区域id，代表订单下单的区位码，区位码是通过省市区转换而来，通过区位码能精确到区内的划分，比如310012是杭州市西湖区华星路'  AFTER `buyer_email` , ADD COLUMN `credit_card_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '使用信用卡支付金额数'  AFTER `area_id` , ADD COLUMN `step_trade_status` VARCHAR(45) NULL DEFAULT '' COMMENT '分阶段付款的订单状态（例如万人团订单等），目前有三返回状态 FRONT_NOPAID_FINAL_NOPAID(定金未付尾款未付)，FRONT_PAID_FINAL_NOPAID(定金已付尾款未付)，FRONT_PAID_FINAL_PAID(定金和尾款都付)'  AFTER `credit_card_fee` , ADD COLUMN `step_paid_fee` VARCHAR(45) NULL DEFAULT '' COMMENT ' 	分阶段付款的已付金额（万人团订单已付金额）'  AFTER `step_trade_status` , ADD COLUMN `mark_desc` VARCHAR(45) NULL DEFAULT '' COMMENT '订单出现异常问题的时候，给予用户的描述,没有异常的时候，此值为空'  AFTER `step_paid_fee` , ADD COLUMN `send_time` VARCHAR(45) NULL DEFAULT '' COMMENT '订单将在此时间前发出，主要用于预售订单'  AFTER `mark_desc` , ADD COLUMN `shipping_type` VARCHAR(45) NULL DEFAULT '' COMMENT ' 	创建交易时的物流方式（交易完成前，物流方式有可能改变，但系统里的这个字段一直不变）。可选值：free(卖家包邮),post(平邮),express(快递),ems(EMS),virtual(虚拟发货)，25(次日必达)，26(预约配送)。'  AFTER `send_time` , ADD COLUMN `buyer_cod_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '买家货到付款服务费。精确到2位小数;单位:元。如:12.07，表示:12元7分'  AFTER `shipping_type` , ADD COLUMN `express_agency_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '快递代收款。精确到2位小数;单位:元。如:212.07，表示:212元7分'  AFTER `buyer_cod_fee` , ADD COLUMN `adjust_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家手工调整金额，精确到2位小数，单位：元。如：200.07，表示：200元7分。来源于订单价格修改，如果有多笔子订单的时候，这个为0，单笔的话则跟[order].adjust_fee一样'  AFTER `express_agency_fee` , ADD COLUMN `buyer_obtain_point_fee` INT(11) NULL DEFAULT NULL COMMENT '买家获得积分,返点的积分。格式:100;单位:个。返点的积分要交易成功之后才能获得。'  AFTER `adjust_fee` , ADD COLUMN `trade_from` VARCHAR(45) NULL DEFAULT '' COMMENT '交易内部来源。 WAP(手机);HITAO(嗨淘);TOP(TOP平台);TAOBAO(普通淘宝);JHS(聚划算) 一笔订单可能同时有以上多个标记，则以逗号分隔'  AFTER `buyer_obtain_point_fee` , ADD COLUMN `alipay_warn_msg` VARCHAR(254) NULL DEFAULT '' COMMENT '淘宝下单成功了,但由于某种错误支付宝订单没有创建时返回的信息。taobao.trade.add接口专用'  AFTER `trade_from` , ADD COLUMN `cod_status` VARCHAR(45) NULL DEFAULT '' COMMENT '货到付款物流状态。 初始状态 NEW_CREATED, 接单成功 ACCEPTED_BY_COMPANY, 接单失败 REJECTED_BY_COMPANY, 接单超时 RECIEVE_TIMEOUT, 揽收成功 TAKEN_IN_SUCCESS, 揽收失败 TAKEN_IN_FAILED, 揽收超时 TAKEN_TIMEOUT, 签收成功 SIGN_IN, 签收失败 REJECTED_BY_OTHER_SIDE, 订单等待发送给物流公司 WAITING_TO_BE_SENT, 用户取消物流订单 CANCELED'  AFTER `alipay_warn_msg` , ADD COLUMN `receiver_city` VARCHAR(45) NULL DEFAULT '' COMMENT '收货人的所在城市\n注：因为国家对于城市和地区的划分的有：省直辖市和省直辖县级行政区（区级别的）划分的，淘宝这边根据这个差异保存在不同字段里面 比如：广东广州：广州属于一个直辖市是放在的receiver_city的字段里面；而河南济源：济源属于省直辖县级行政区划分，是区级别的，放在了receiver_district里面\n建议：程序依赖于城市字段做物流等判断的操作，最好加一个判断逻辑：如果返回值里面只有receiver_district参数，该参数作为城市'  AFTER `cod_status` , ADD COLUMN `receiver_district` VARCHAR(45) NULL DEFAULT '' COMMENT '收货人的所在地区\n注：因为国家对于城市和地区的划分的有：省直辖市和省直辖县级行政区（区级别的）划分的，淘宝这边根据这个差异保存在不同字段里面 比如：广东广州：广州属于一个直辖市是放在的receiver_city的字段里面；而河南济源：济源属于省直辖县级行政区划分，是区级别的，放在了receiver_district里面\n建议：程序依赖于城市字段做物流等判断的操作，最好加一个判断逻辑：如果返回值里面只有receiver_district参数，该参数作为城市'  AFTER `receiver_city` , ADD COLUMN `seller_nick` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家昵称'  AFTER `receiver_district` , ADD COLUMN `payment` VARCHAR(45) NULL DEFAULT '' COMMENT '实付金额。精确到2位小数;单位:元。如:200.07，表示:200元7分'  AFTER `seller_nick` , ADD COLUMN `snapshot_url` VARCHAR(45) NULL DEFAULT '' COMMENT '交易快照地址'  AFTER `payment` , ADD COLUMN `post_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '邮费。精确到2位小数;单位:元。如:200.07，表示:200元7分'  AFTER `snapshot_url` , ADD COLUMN `buyer_alipay_no` VARCHAR(45) NULL DEFAULT '' COMMENT '买家支付宝账号'  AFTER `post_fee` , ADD COLUMN `receiver_mobile` VARCHAR(45) NULL DEFAULT '' COMMENT '收货人的手机号码'  AFTER `buyer_alipay_no` , ADD COLUMN `consign_time` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家发货时间。格式:yyyy-MM-dd HH:mm:ss'  AFTER `receiver_mobile` , ADD COLUMN `receiver_phone` VARCHAR(45) NULL DEFAULT '' COMMENT '收货人的电话号码'  AFTER `consign_time` , ADD COLUMN `seller_alipay_no` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家支付宝账号'  AFTER `receiver_phone` , ADD COLUMN `seller_mobile` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家手机'  AFTER `seller_alipay_no` , ADD COLUMN `seller_phone` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家电话'  AFTER `seller_mobile` , ADD COLUMN `seller_name` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家姓名'  AFTER `seller_phone` , ADD COLUMN `seller_email` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家邮件地址'  AFTER `seller_name` , ADD COLUMN `available_confirm_fee` VARCHAR(45) NULL DEFAULT '' COMMENT '交易中剩余的确认收货金额（这个金额会随着子订单确认收货而不断减少，交易成功后会变为零）。精确到2位小数;单位:元。如:200.07，表示:200 元7分'  AFTER `seller_email` , ADD COLUMN `received_payment` VARCHAR(45) NULL DEFAULT '' COMMENT '卖家实际收到的支付宝打款金额（由于子订单可以部分确认收货，这个金额会随着子订单的确认收货而不断增加，交易成功后等于买家实付款减去退款金额）。精确到2位小数;单位:元。如:200.07，表示:200元7分'  AFTER `available_confirm_fee` , ADD COLUMN `gmt_created` VARCHAR(45) NULL DEFAULT NULL  AFTER `received_payment` , ADD COLUMN `gmt_modified` VARCHAR(45) NULL DEFAULT NULL  AFTER `gmt_created` , 
COMMENT = '交易信息' ;

ALTER TABLE `asto_ec_web`.`tb_order` ADD COLUMN `oid` VARCHAR(45) NULL DEFAULT NULL COMMENT '子订单编号'  AFTER `id` , ADD COLUMN `status` VARCHAR(45) NULL DEFAULT NULL COMMENT '订单状态（请关注此状态，如果为TRADE_CLOSED_BY_TAOBAO状态，则不要对此订单进行发货，切记啊！）。可选值:\n\n    TRADE_NO_CREATE_PAY(没有创建支付宝交易)\n    WAIT_BUYER_PAY(等待买家付款)\n    WAIT_SELLER_SEND_GOODS(等待卖家发货,即:买家已付款)\n    WAIT_BUYER_CONFIRM_GOODS(等待买家确认收货,即:卖家已发货)\n    TRADE_BUYER_SIGNED(买家已签收,货到付款专用)\n    TRADE_FINISHED(交易成功)\n    TRADE_CLOSED(付款以后用户退款成功，交易自动关闭)\n    TRADE_CLOSED_BY_TAOBAO(付款以前，卖家或买家主动关闭交易)'  AFTER `oid` , ADD COLUMN `title` VARCHAR(45) NULL DEFAULT NULL  AFTER `status` , ADD COLUMN `price` VARCHAR(45) NULL DEFAULT NULL COMMENT '商品价格。精确到2位小数;单位:元。如:200.07，表示:200元7分'  AFTER `title` , ADD COLUMN `num_iid` INT(11) NULL DEFAULT NULL COMMENT '商品数字ID'  AFTER `price` , ADD COLUMN `item_meal_id` VARCHAR(45) NULL DEFAULT NULL COMMENT '套餐ID'  AFTER `num_iid` , ADD COLUMN `sku_id` VARCHAR(45) NULL DEFAULT NULL COMMENT '商品的最小库存单位Sku的id.可以通过taobao.item.sku.get获取详细的Sku信息'  AFTER `item_meal_id` , ADD COLUMN `num` INT(11) NULL DEFAULT NULL COMMENT '购买数量。取值范围:大于零的整数'  AFTER `sku_id` , ADD COLUMN `outer_sku_id` VARCHAR(45) NULL DEFAULT NULL COMMENT '外部网店自己定义的Sku编号'  AFTER `num` , ADD COLUMN `order_from` VARCHAR(45) NULL DEFAULT NULL COMMENT '子订单来源,如jhs(聚划算)、taobao(淘宝)、wap(无线)'  AFTER `outer_sku_id` , ADD COLUMN `total_fee` VARCHAR(45) NULL DEFAULT NULL COMMENT '应付金额（商品价格 * 商品数量 + 手工调整金额 - 子订单级订单优惠金额）。精确到2位小数;单位:元。如:200.07，表示:200元7分'  AFTER `order_from` , ADD COLUMN `payment` VARCHAR(45) NULL DEFAULT NULL COMMENT '子订单实付金额。精确到2位小数，单位:元。如:200.07，表示:200元7分。对于多子订单的交易，计算公式如下：payment = price * num + adjust_fee - discount_fee ；单子订单交易，payment与主订单的payment一致，对于退款成功的子订单，由于主订单的优惠分摊金额，会造成该字段可能不为0.00元。建议使用退款前的实付金额减去退款单中的实际退款金额计算。'  AFTER `total_fee` , ADD COLUMN `discount_fee` VARCHAR(45) NULL DEFAULT NULL COMMENT '子订单级订单优惠金额。精确到2位小数;单位:元。如:200.07，表示:200元7分'  AFTER `payment` , ADD COLUMN `adjust_fee` VARCHAR(45) NULL DEFAULT NULL COMMENT '手工调整金额.格式为:1.01;单位:元;精确到小数点后两位.'  AFTER `discount_fee` , ADD COLUMN `modified` DATETIME NULL DEFAULT NULL COMMENT '订单修改时间，目前只有taobao.trade.ordersku.update会返回此字段。'  AFTER `adjust_fee` , ADD COLUMN `sku_properties_name` VARCHAR(45) NULL DEFAULT NULL COMMENT 'SKU的值。如：机身颜色:黑色;手机套餐:官方标配'  AFTER `modified` , ADD COLUMN `refund_id` VARCHAR(45) NULL DEFAULT NULL COMMENT '最近退款ID'  AFTER `sku_properties_name` , ADD COLUMN `is_oversold` VARCHAR(45) NULL DEFAULT NULL COMMENT '是否超卖'  AFTER `refund_id` , ADD COLUMN `is_service_order` VARCHAR(45) NULL DEFAULT NULL COMMENT '是否是服务订单，是返回true，否返回false。'  AFTER `is_oversold` , ADD COLUMN `end_time` DATETIME NULL DEFAULT NULL COMMENT '子订单的交易结束时间 说明：子订单有单独的结束时间，与主订单的结束时间可能有所不同，在有退款发起的时候或者是主订单分阶段付款的时候，子订单的结束时间会早于主订单的结束时间，所以开放这个字段便于订单结束状态的判断'  AFTER `is_service_order` , ADD COLUMN `bind_oid` VARCHAR(45) NULL DEFAULT NULL COMMENT '捆绑的子订单号，表示该子订单要和捆绑的子订单一起发货，用于卖家子订单捆绑发货'  AFTER `end_time` , ADD COLUMN `logistics_company` VARCHAR(45) NULL DEFAULT NULL COMMENT '子订单发货的快递公司名称'  AFTER `bind_oid` , ADD COLUMN `invoice_no` VARCHAR(45) NULL DEFAULT NULL COMMENT '子订单所在包裹的运单号'  AFTER `logistics_company` , ADD COLUMN `item_meal_name` VARCHAR(45) NULL DEFAULT NULL COMMENT '套餐的值。如：M8原装电池:便携支架:M8专用座充:莫凡保护袋'  AFTER `invoice_no` , ADD COLUMN `pic_path` VARCHAR(45) NULL DEFAULT NULL COMMENT '商品图片的绝对路径'  AFTER `item_meal_name` , ADD COLUMN `seller_nick` VARCHAR(45) NULL DEFAULT NULL COMMENT '卖家昵称'  AFTER `pic_path` , ADD COLUMN `buyer_nick` VARCHAR(45) NULL DEFAULT NULL COMMENT '买家昵称'  AFTER `seller_nick` , ADD COLUMN `refund_status` VARCHAR(45) NULL DEFAULT NULL COMMENT '退款状态。退款状态。可选值 WAIT_SELLER_AGREE(买家已经申请退款，等待卖家同意) WAIT_BUYER_RETURN_GOODS(卖家已经同意退款，等待买家退货) WAIT_SELLER_CONFIRM_GOODS(买家已经退货，等待卖家确认收货) SELLER_REFUSE_BUYER(卖家拒绝退款) CLOSED(退款关闭) SUCCESS(退款成功)'  AFTER `buyer_nick` , ADD COLUMN `outer_iid` VARCHAR(45) NULL DEFAULT NULL COMMENT '商家外部编码(可与商家外部系统对接)。外部商家自己定义的商品Item的id，可以通过taobao.items.custom.get获取商品的Item的信息'  AFTER `refund_status` , ADD COLUMN `snapshot_url` VARCHAR(45) NULL DEFAULT NULL COMMENT '订单快照URL'  AFTER `outer_iid` , ADD COLUMN `timeout_action_time` DATETIME NULL DEFAULT NULL COMMENT '订单超时到期时间。格式:yyyy-MM-dd HH:mm:ss'  AFTER `snapshot_url` , ADD COLUMN `seller_type` VARCHAR(45) NULL DEFAULT NULL COMMENT '卖家类型，可选值为：B（商城商家），C（普通卖家）'  AFTER `timeout_action_time` , ADD COLUMN `cid` VARCHAR(45) NULL DEFAULT NULL COMMENT '交易商品对应的类目ID'  AFTER `seller_type` , ADD COLUMN `gmt_created` DATETIME NULL DEFAULT NULL  AFTER `cid` , ADD COLUMN `gmt_modified` DATETIME NULL DEFAULT NULL  AFTER `gmt_created` ;

ALTER TABLE `asto_ec_web`.`sys_task` CHANGE COLUMN `method` `method` VARCHAR(254) NULL DEFAULT '' COMMENT '此任务是由哪个api产生的'  
, ADD INDEX `idx_method` (`method` ASC) ;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
